<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="docstyle.css" type="text/css">
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});
</script><script type="text/javascript"
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link rel="previous" href="Kinsol.html">
<link rel="next" href="Arkode.html">
<link rel="Up" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Sundials" rel="Chapter" href="Sundials.html">
<link title="Nvector" rel="Chapter" href="Nvector.html">
<link title="Dls" rel="Chapter" href="Dls.html">
<link title="Sls" rel="Chapter" href="Sls.html">
<link title="Spils" rel="Chapter" href="Spils.html">
<link title="Nvector_custom" rel="Chapter" href="Nvector_custom.html">
<link title="Nvector_array" rel="Chapter" href="Nvector_array.html">
<link title="Nvector_serial" rel="Chapter" href="Nvector_serial.html">
<link title="Cvode" rel="Chapter" href="Cvode.html">
<link title="Kinsol" rel="Chapter" href="Kinsol.html">
<link title="Ida" rel="Chapter" href="Ida.html">
<link title="Arkode" rel="Chapter" href="Arkode.html">
<link title="Cvodes" rel="Chapter" href="Cvodes.html">
<link title="Idas" rel="Chapter" href="Idas.html">
<link title="Nvector_parallel" rel="Chapter" href="Nvector_parallel.html">
<link title="Kinsol_bbd" rel="Chapter" href="Kinsol_bbd.html">
<link title="Arkode_bbd" rel="Chapter" href="Arkode_bbd.html">
<link title="Cvode_bbd" rel="Chapter" href="Cvode_bbd.html">
<link title="Cvodes_bbd" rel="Chapter" href="Cvodes_bbd.html">
<link title="Ida_bbd" rel="Chapter" href="Ida_bbd.html">
<link title="Idas_bbd" rel="Chapter" href="Idas_bbd.html">
<link title="Nvector_openmp" rel="Chapter" href="Nvector_openmp.html">
<link title="Nvector_pthreads" rel="Chapter" href="Nvector_pthreads.html"><link title="Linear solvers" rel="Section" href="#linear">
<link title="Tolerances" rel="Section" href="#tols">
<link title="Initialization" rel="Section" href="#init">
<link title="Solution" rel="Section" href="#solver">
<link title="Modifying the solver (optional input functions)" rel="Section" href="#set">
<link title="Querying the solver (optional output functions)" rel="Section" href="#get">
<link title="Additional root-finding functions" rel="Section" href="#roots">
<link title="Exceptions" rel="Section" href="#exceptions">
<link title="Initial Condition Calculation" rel="Subsection" href="#calcic">
<title>Sundials/ML 2.6.2p0 : Ida</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Kinsol.html" title="Kinsol">Previous</a>
&nbsp;<a class="up" href="index.html" title="Index">Up</a>
&nbsp;<a class="post" href="Arkode.html" title="Arkode">Next</a>
</div>
<h1>Module <a href="type_Ida.html">Ida</a></h1>

<pre><span class="keyword">module</span> Ida: <code class="code"><span class="keyword">sig</span></code> <a href="Ida.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info module top">
Variable-step solution of DAE initial value problems with
    zero-crossing detection.
<p>

    This module solves numerically problems of the form
    $F(t, y, \dot{y})=0$, $y(t_0) = y_0$,
    $\dot{y}(t_0)=\dot{y}_0$.
<p>

    This documented interface is structured as follows.
    <OL>
<li><a href="#linear">Linear solvers</a></li>
<li><a href="#tols">Tolerances</a></li>
<li><a href="#init">Initialization</a></li>
<li><a href="#solver">Solution</a></li>
<li><a href="#set">Modifying the solver</a></li>
<li><a href="#get">Querying the solver</a></li>
<li><a href="#roots">Additional root finding functions</a></li>
<li><a href="#exceptions">Exceptions</a></li>
</OL>
<br>
<div class="authors"><b>Author(s):</b> Timothy Bourke (Inria/ENS), Jun Inoue (Inria/ENS), Marc Pouzet (UPMC/ENS/Inria)</div>
<b>Version:</b> 2.6.2<br>
</div>
<hr width="100%">

<pre><span id="TYPEsession"><span class="keyword">type</span> <code class="type">('d, 'k)</code> session</span> = <code class="type">('d, 'k) session</code> </pre>
<div class="info ">
A session with the IDA solver.
<p>

    An example session with Ida (<a href="ida_skel.ml">ida_skel.ml</a>): <pre class="codepre"><code class="code"><span class="comment">(*&nbsp;1.&nbsp;Define&nbsp;a&nbsp;residual&nbsp;function.&nbsp;*)</span>
<span class="keyword">let</span>&nbsp;resf&nbsp;t&nbsp;v&nbsp;v'&nbsp;r&nbsp;=
&nbsp;&nbsp;r.{0}&nbsp;&lt;-&nbsp;v.{2}&nbsp;&nbsp;-.&nbsp;v'.{0};
&nbsp;&nbsp;r.{1}&nbsp;&lt;-&nbsp;v.{3}&nbsp;&nbsp;-.&nbsp;v'.{1};
&nbsp;&nbsp;r.{2}&nbsp;&lt;-&nbsp;v'.{2}&nbsp;-.&nbsp;v.{4}&nbsp;*.&nbsp;v.{0};
&nbsp;&nbsp;r.{3}&nbsp;&lt;-&nbsp;v'.{3}&nbsp;-.&nbsp;v.{4}&nbsp;*.&nbsp;v.{1}&nbsp;+.&nbsp;9.81;
&nbsp;&nbsp;r.{4}&nbsp;&lt;-&nbsp;v.{2}*.v.{2}&nbsp;+.&nbsp;v'.{2}*.v.{0}&nbsp;+.&nbsp;v.{3}*.v'.{1}&nbsp;+.&nbsp;v'.{3}*.v.{1}

<span class="comment">(*&nbsp;2.&nbsp;Optionally&nbsp;define&nbsp;a&nbsp;root&nbsp;function.&nbsp;*)</span>
<span class="keyword">let</span>&nbsp;g&nbsp;t&nbsp;v&nbsp;v'&nbsp;gout&nbsp;=&nbsp;gout.{0}&nbsp;&lt;-&nbsp;v.{0}&nbsp;-.&nbsp;v.{1}&nbsp;*.&nbsp;0.5774

<span class="comment">(*&nbsp;3.&nbsp;Set&nbsp;vector&nbsp;of&nbsp;initial&nbsp;values.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;length&nbsp;of&nbsp;this&nbsp;vector&nbsp;determines&nbsp;the&nbsp;problem&nbsp;size.&nbsp;*)</span>
<span class="keyword">let</span>&nbsp;vd&nbsp;=&nbsp;<span class="constructor">Sundials</span>.<span class="constructor">RealArray</span>.of_list&nbsp;[&nbsp;0.9848;&nbsp;0.1736;&nbsp;0.0;&nbsp;0.0;&nbsp;0.0&nbsp;]
<span class="keyword">let</span>&nbsp;v&nbsp;&nbsp;=&nbsp;<span class="constructor">Nvector_serial</span>.wrap&nbsp;vd
<span class="keyword">let</span>&nbsp;v'&nbsp;=&nbsp;<span class="constructor">Nvector_serial</span>.make&nbsp;5&nbsp;0.0

<span class="comment">(*&nbsp;4.&nbsp;Create&nbsp;and&nbsp;initialize&nbsp;a&nbsp;solver&nbsp;session.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;will&nbsp;initialize&nbsp;a&nbsp;specific&nbsp;linear&nbsp;solver&nbsp;and&nbsp;the&nbsp;root-finding
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mechanism,&nbsp;if&nbsp;necessary.&nbsp;*)</span>
<span class="keyword">let</span>&nbsp;s&nbsp;=&nbsp;<span class="constructor">Ida</span>.(init&nbsp;(<span class="constructor">Dls</span>.dense&nbsp;())
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="constructor">SStolerances</span>&nbsp;(1e-9,&nbsp;1e-9))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resf&nbsp;~roots:(1,&nbsp;g)&nbsp;0.0&nbsp;v&nbsp;v');;

<span class="comment">(*&nbsp;5.&nbsp;Set&nbsp;optional&nbsp;inputs,&nbsp;e.g.,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;[set_*]&nbsp;functions&nbsp;to&nbsp;change&nbsp;solver&nbsp;parameters.&nbsp;*)</span>
<span class="constructor">Ida</span>.set_stop_time&nbsp;s&nbsp;10.0;
<span class="constructor">Ida</span>.set_all_root_directions&nbsp;s&nbsp;<span class="constructor">Sundials</span>.<span class="constructor">RootDirs</span>.<span class="constructor">Decreasing</span>;;

<span class="comment">(*&nbsp;6.&nbsp;Correct&nbsp;initial&nbsp;values&nbsp;*)</span>
<span class="keyword">let</span>&nbsp;vids&nbsp;=&nbsp;<span class="constructor">Nvector_serial</span>.make&nbsp;5&nbsp;<span class="constructor">Ida</span>.<span class="constructor">VarId</span>.differential;;
(<span class="constructor">Nvector_serial</span>.unwrap&nbsp;vids).{4}&nbsp;&lt;-&nbsp;<span class="constructor">Ida</span>.<span class="constructor">VarId</span>.algebraic;

<span class="constructor">Ida</span>.set_suppress_alg&nbsp;s&nbsp;~varid:vids&nbsp;<span class="keyword">true</span>;
<span class="constructor">Ida</span>.calc_ic_ya_yd'&nbsp;s&nbsp;~y:v&nbsp;~y':v'&nbsp;0.1;;

<span class="comment">(*&nbsp;7.&nbsp;Advance&nbsp;the&nbsp;solution&nbsp;in&nbsp;time,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by&nbsp;repeatedly&nbsp;calling&nbsp;[solve_normal]&nbsp;or&nbsp;[solve_one_step].&nbsp;*)</span>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;go&nbsp;(t,&nbsp;r)&nbsp;=
&nbsp;&nbsp;<span class="constructor">Printf</span>.printf&nbsp;<span class="string">"%&nbsp;.10e\t%&nbsp;.10e\t%&nbsp;.10e\t%&nbsp;.10e\t%&nbsp;.10e\t%&nbsp;.10e\n"</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t&nbsp;vd.{0}&nbsp;vd.{1}&nbsp;vd.{2}&nbsp;vd.{3}&nbsp;vd.{4};
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;r&nbsp;<span class="keyword">with</span>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Ida</span>.<span class="constructor">Success</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;go&nbsp;(<span class="constructor">Ida</span>.solve_normal&nbsp;s&nbsp;(t&nbsp;+.&nbsp;0.05)&nbsp;v&nbsp;v')
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Ida</span>.<span class="constructor">RootsFound</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">begin</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vd.{2}&nbsp;&lt;-&nbsp;-.&nbsp;0.5&nbsp;*.&nbsp;vd.{2};
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vd.{3}&nbsp;&lt;-&nbsp;-.&nbsp;0.5&nbsp;*.&nbsp;vd.{3};
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Ida</span>.reinit&nbsp;s&nbsp;t&nbsp;v&nbsp;v';
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Ida</span>.calc_ic_ya_yd'&nbsp;~y:v&nbsp;~y':v'&nbsp;s&nbsp;~varid:vids&nbsp;(t&nbsp;+.&nbsp;0.05);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;go&nbsp;(t,&nbsp;<span class="constructor">Ida</span>.<span class="constructor">Success</span>)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Ida</span>.<span class="constructor">StopTimeReached</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;();;

<span class="constructor">Printf</span>.printf&nbsp;<span class="string">"time\tx\ty\tx'\ty'\tp\n"</span>;;
go&nbsp;(0.0,&nbsp;<span class="constructor">Ida</span>.<span class="constructor">Success</span>);;

<span class="comment">(*&nbsp;8.&nbsp;Get&nbsp;optional&nbsp;outputs,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;the&nbsp;[get_*]&nbsp;functions&nbsp;to&nbsp;examine&nbsp;solver&nbsp;statistics.&nbsp;*)</span>
<span class="keyword">let</span>&nbsp;ns&nbsp;=&nbsp;<span class="constructor">Ida</span>.get_num_steps&nbsp;s

&nbsp;&nbsp;&nbsp;&nbsp;</code></pre><br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:skeleton_sim">Skeleton of main program</a></div></div>


<pre><span id="TYPEserial_session"><span class="keyword">type</span> <code class="type">[> <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ]</code> serial_session</span> = <code class="type">(<a href="Sundials.RealArray.html#TYPEt">Sundials.RealArray.t</a>, [> <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ] as 'a) <a href="Ida.html#TYPEsession">session</a></code> </pre>
<div class="info ">
Alias for sessions based on serial nvectors.<br>
</div>

<br>
<h2 id="linear">Linear solvers</h2><br>

<pre><span id="TYPElinear_solver"><span class="keyword">type</span> <code class="type">('data, 'kind)</code> linear_solver</span> = <code class="type">('data, 'kind) linear_solver</code> </pre>
<div class="info ">
Linear solvers used by Ida.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:lin_solv_init">Linear Solver Specification Functions</a></div></div>


<pre><span id="TYPEserial_linear_solver"><span class="keyword">type</span> <code class="type">[> <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ]</code> serial_linear_solver</span> = <code class="type">(<a href="Nvector_serial.html#TYPEdata">Nvector_serial.data</a>, [> <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ] as 'a) <a href="Ida.html#TYPElinear_solver">linear_solver</a></code> </pre>
<div class="info ">
Alias for linear solvers that are restricted to serial nvectors.<br>
</div>


<pre><span id="TYPEdouble"><span class="keyword">type</span> <code class="type">'d</code> double</span> = <code class="type">'d * 'd</code> </pre>
<div class="info ">
Workspaces with two temporary vectors.<br>
</div>


<pre><span id="TYPEtriple"><span class="keyword">type</span> <code class="type">'d</code> triple</span> = <code class="type">'d * 'd * 'd</code> </pre>
<div class="info ">
Workspaces with three temporary vectors.<br>
</div>


<pre><span id="TYPEjacobian_arg"><span class="keyword">type</span> <code class="type">('t, 'd)</code> jacobian_arg</span> = <code class="type">('t, 'd) jacobian_arg</code> = {</pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTjacobian_arg.jac_t">jac_t</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The independent variable.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTjacobian_arg.jac_y">jac_y</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The dependent variable vector.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTjacobian_arg.jac_y'">jac_y'</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The derivative vector (i.e.
                                  $\frac{\mathrm{d}y}{\mathrm{d}t}$).<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTjacobian_arg.jac_res">jac_res</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The current value of the residual vector.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTjacobian_arg.jac_coef">jac_coef</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The coefficient $c_j$ in
                                 $J = \frac{\partial F}{\partial y} + c_j \frac{\partial F}{\partial\dot{y}}$.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTjacobian_arg.jac_tmp">jac_tmp</span>&nbsp;: <code class="type">'t</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Workspace data.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
}

<div class="info ">
Arguments common to Jacobian callback functions.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:djacFn">IDADlsDenseJacFn</a></div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:bjacFn">IDADlsBandJacFn</a></div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:jtimesFn">IDASpilsJacTimesVecFn</a></div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:psolveFn">IDASpilsPrecSolveFn</a></div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:precondFn">IDASpilsPrecSetupFn</a></div></div>


<pre><span id="TYPEbandrange"><span class="keyword">type</span> <code class="type"></code>bandrange</span> = <code class="type">bandrange</code> = {</pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTbandrange.mupper">mupper</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The upper half-bandwidth.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTbandrange.mlower">mlower</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The lower half-bandwidth.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
}

<div class="info ">
The range of nonzero entries in a band matrix.<br>
</div>


<pre><span class="keyword">module</span> <a href="Ida.Dls.html">Dls</a>: <code class="code"><span class="keyword">sig</span></code> <a href="Ida.Dls.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
Direct Linear Solvers operating on dense and banded matrices.
</div>

<pre><span class="keyword">module</span> <a href="Ida.Sls.html">Sls</a>: <code class="code"><span class="keyword">sig</span></code> <a href="Ida.Sls.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
Sparse Linear Solvers.
</div>

<pre><span class="keyword">module</span> <a href="Ida.Spils.html">Spils</a>: <code class="code"><span class="keyword">sig</span></code> <a href="Ida.Spils.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
Scaled Preconditioned Iterative Linear Solvers.
</div>

<pre><span class="keyword">module</span> <a href="Ida.Alternate.html">Alternate</a>: <code class="code"><span class="keyword">sig</span></code> <a href="Ida.Alternate.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
Alternate Linear Solvers.
</div>
<br>
<h2 id="tols">Tolerances</h2><br>

<pre><span id="TYPEerror_weight_fun"><span class="keyword">type</span> <code class="type">'data</code> error_weight_fun</span> = <code class="type">'data -> 'data -> unit</code> </pre>
<div class="info ">
Functions that set the multiplicative error weights for use in the weighted
    RMS norm. The call <code class="code">efun y ewt</code> takes the dependent variable vector <code class="code">y</code> and
    fills the error-weight vector <code class="code">ewt</code> with positive values or raises
    <a href="Sundials.html#EXCEPTIONNonPositiveEwt"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">NonPositiveEwt</span></code></a>. Other exceptions are eventually propagated, but
    should be avoided (<code class="code">efun</code> is not allowed to abort the solver).<br>
</div>


<pre><code><span id="TYPEtolerance"><span class="keyword">type</span> <code class="type">('data, 'kind)</code> tolerance</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtolerance.SStolerances"><span class="constructor">SStolerances</span></span> <span class="keyword">of</span> <code class="type">float * float</code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<code class="code">(rel, abs)</code> : scalar relative and absolute tolerances.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtolerance.SVtolerances"><span class="constructor">SVtolerances</span></span> <span class="keyword">of</span> <code class="type">float * ('data, 'kind) <a href="Nvector.html#TYPEt">Nvector.t</a></code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<code class="code">(rel, abs)</code> : scalar relative and vector absolute tolerances.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtolerance.WFtolerances"><span class="constructor">WFtolerances</span></span> <span class="keyword">of</span> <code class="type">'data <a href="Ida.html#TYPEerror_weight_fun">error_weight_fun</a></code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Set the multiplicative error weights for the weighted RMS norm.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
Tolerance specifications.<br>
</div>


<pre><span id="VALdefault_tolerances"><span class="keyword">val</span> default_tolerances</span> : <code class="type">('data, 'kind) <a href="Ida.html#TYPEtolerance">tolerance</a></code></pre><div class="info ">
A default relative tolerance of 1.0e-4 and absolute tolerance of 1.0e-8.<br>
</div>
<br>
<h2 id="init">Initialization</h2><br>

<pre><span id="TYPEresfn"><span class="keyword">type</span> <code class="type">'d</code> resfn</span> = <code class="type">float -> 'd -> 'd -> 'd -> unit</code> </pre>
<div class="info ">
Residual functions that define a DAE problem. They are passed four
 * arguments:<ul>
<li><code class="code">t</code>, the value of the independent variable, i.e., the simulation time,</li>
<li><code class="code">y</code>, the vector of dependent-variable values, i.e., $y(t)$,</li>
<li><code class="code">y'</code>, the vector of dependent-variable derivatives, i.e.,
            $\dot{y} = \frac{\mathrm{d}y}{\mathrm{d}t}$, and,</li>
<li><code class="code">r</code> a vector for storing the residual value, $F(t, y, \dot{y})$.</li>
</ul>

    Within the function, raising a <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> exception
    indicates a recoverable error. Any other exception is treated as an
    unrecoverable error.
<p>

    <div class="warningbox"> <code class="code">y</code>, <code class="code">y'</code>, and <code class="code">r</code> should not be accessed after the function
             returns.</div><br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:resFn">IDAResFn</a></div></div>


<pre><span id="TYPErootsfn"><span class="keyword">type</span> <code class="type">'d</code> rootsfn</span> = <code class="type">float -> 'd -> 'd -> <a href="Sundials.RealArray.html#TYPEt">Sundials.RealArray.t</a> -> unit</code> </pre>
<div class="info ">
Called by the solver to calculate the values of root functions. These
    ‘zero-crossings’ are used to detect significant events. The function is
    passed four arguments:<ul>
<li><code class="code">t</code>, the value of the independent variable, i.e., the simulation time,</li>
<li><code class="code">y</code>, the vector of dependent-variable values, i.e., $y(t)$,</li>
<li><code class="code">y'</code>, the vector of dependent-variable derivatives, i.e.,
            $\dot{y} = \frac{\mathrm{d}y}{\mathrm{d}t}$, and,</li>
<li><code class="code">gout</code>, a vector for storing the value of $g(t, y, \dot{y})$.</li>
</ul>

    <div class="warningbox"> <code class="code">y</code>, <code class="code">y'</code>, and <code class="code">gout</code> should not be accessed after the function
             has returned.</div><br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:rootFn">IDARootFn</a></div></div>


<pre><span id="VALinit"><span class="keyword">val</span> init</span> : <code class="type">('d, 'kind) <a href="Ida.html#TYPElinear_solver">linear_solver</a> -><br>       ('d, 'kind) <a href="Ida.html#TYPEtolerance">tolerance</a> -><br>       'd <a href="Ida.html#TYPEresfn">resfn</a> -><br>       ?varid:('d, 'kind) <a href="Nvector.html#TYPEt">Nvector.t</a> -><br>       ?roots:int * 'd <a href="Ida.html#TYPErootsfn">rootsfn</a> -><br>       float -><br>       ('d, 'kind) <a href="Nvector.html#TYPEt">Nvector.t</a> -> ('d, 'kind) <a href="Nvector.html#TYPEt">Nvector.t</a> -> ('d, 'kind) <a href="Ida.html#TYPEsession">session</a></code></pre><div class="info ">
Creates and initializes a session with the solver. The call
    <pre class="codepre"><code class="code">init&nbsp;linsolv&nbsp;tol&nbsp;f&nbsp;~varid:varid&nbsp;~roots:(nroots,&nbsp;g)&nbsp;t0&nbsp;y0&nbsp;y'0</code></pre> has
    as arguments:<ul>
<li><code class="code">linsolv</code>, the linear solver to use,</li>
<li><code class="code">tol</code>,     the integration tolerances,</li>
<li><code class="code">f</code>,       the DAE residual function,</li>
<li><code class="code">varid</code>,   optionally classifies variables as algebraic or differential,</li>
<li><code class="code">nroots</code>,  the number of root functions,</li>
<li><code class="code">g</code>,       the root function (<code class="code">(nroots, g)</code> defaults to <a href="Ida.html#VALno_roots"><code class="code"><span class="constructor">Ida</span>.no_roots</code></a>),</li>
<li><code class="code">t0</code>,      the initial value of the independent variable,</li>
<li><code class="code">y0</code>,      a vector of initial values that also determines the number
                 of equations, and,</li>
<li><code class="code">y'0</code>,     the initial values for
                 $\dot{y} = \frac{\mathrm{d}y}{\mathrm{d}t}$.</li>
</ul>

    This function does everything necessary to initialize a session, i.e.,
    it makes the calls referenced below. The <a href="Ida.html#VALsolve_normal"><code class="code"><span class="constructor">Ida</span>.solve_normal</code></a> and
    <a href="Ida.html#VALsolve_one_step"><code class="code"><span class="constructor">Ida</span>.solve_one_step</code></a> functions may be called directly.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:idainit">      IDACreate/IDAInit</a></div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:idarootinit">   IDARootInit</a></div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:lin_solv_init">Linear solvers</a></div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:idatolerances">IDASStolerances</a></div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:idatolerances">IDASVtolerances</a></div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:idatolerances">IDAWFtolerances</a></div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:ewtsetFn">      IDAEwtFn</a></div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:idasetid">     IDASetId</a></div></div>

<pre><span id="VALno_roots"><span class="keyword">val</span> no_roots</span> : <code class="type">int * 'd <a href="Ida.html#TYPErootsfn">rootsfn</a></code></pre><div class="info ">
A convenience value for signalling that there are no roots to monitor.<br>
</div>
<br>
<h3 id="calcic">Initial Condition Calculation</h3><br>

<pre><span class="keyword">module</span> <a href="Ida.VarId.html">VarId</a>: <code class="code"><span class="keyword">sig</span></code> <a href="Ida.VarId.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
Symbolic names for constants used when calculating initial values or
    supressing local error tests.
</div>

<pre><span id="VALset_id"><span class="keyword">val</span> set_id</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> unit</code></pre><div class="info ">
Class components of the state vector as either algebraic or differential.
    These classifications are required by <a href="Ida.html#VALcalc_ic_ya_yd'"><code class="code"><span class="constructor">Ida</span>.calc_ic_ya_yd'</code></a> and
    <a href="Ida.html#VALset_suppress_alg"><code class="code"><span class="constructor">Ida</span>.set_suppress_alg</code></a>. See also <a href="Ida.VarId.html"><code class="code"><span class="constructor">Ida</span>.<span class="constructor">VarId</span></code></a>.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optin_main">IDASetId</a></div></div>

<pre><span id="VALset_suppress_alg"><span class="keyword">val</span> set_suppress_alg</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> ?varid:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> bool -> unit</code></pre><div class="info ">
Indicates whether or not to ignore algebraic variables in the local error
    test. When ignoring algebraic variables (<code class="code"><span class="keyword">true</span></code>), a <code class="code">varid</code> vector must be
    specified either in the call or by a prior call to <a href="Ida.html#VALinit"><code class="code"><span class="constructor">Ida</span>.init</code></a> or <a href="Ida.html#VALset_id"><code class="code"><span class="constructor">Ida</span>.set_id</code></a>.
    Suppressing local error tests for algebraic variables is <i>discouraged</i>
    for DAE systems of index 1 and <i>encouraged</i> for systems of index 2 or
    more.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optin_main">IDASetId</a></div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optin_main">IDASetSuppressAlg</a></div></div>

<pre><span id="VALcalc_ic_y"><span class="keyword">val</span> calc_ic_y</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> ?y:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> float -> unit</code></pre><div class="info ">
Computes the initial state vector for certain index-one problems.
    All components of $y$ are computed, using $\dot{y}$, to satisfy
    the constraint $F(t_0, y_0, \dot{y}_0) = 0$. If given, the
    <code class="code">~y</code> vector is filled with the corrected values. The last argument is
    the first vale of $t$ at which a solution will be requested.
    A <a href="Ida.html#VALreinit"><code class="code"><span class="constructor">Ida</span>.reinit</code></a> is required before calling this function after
    <a href="Ida.html#VALsolve_normal"><code class="code"><span class="constructor">Ida</span>.solve_normal</code></a> or <a href="Ida.html#VALsolve_one_step"><code class="code"><span class="constructor">Ida</span>.solve_one_step</code></a>.<br>
<div class="raisedexceptions"><span class="raises">Raises</span> <code>IdNotSet</code> Variable ids have not been set (see <a href="Ida.html#VALset_id"><code class="code"><span class="constructor">Ida</span>.set_id</code></a>).</div>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:idacalcic">IDACalcIC (IDA_Y_INIT)</a></div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optout_iccalc">IDAGetConsistentIC</a></div></div>

<pre><span id="VALcalc_ic_ya_yd'"><span class="keyword">val</span> calc_ic_ya_yd'</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -><br>       ?y:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -><br>       ?y':('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> ?varid:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> float -> unit</code></pre><div class="info ">
Computes the algebraic components of the initial state and derivative
    vectors for certain index-one problems.
    The elements of $y$ and $\dot{y}$ marked as algebraic are computed,
    using $\dot{y}$, to satisfy the constraint
    $F(t_0, y_0, \dot{y}_0) = 0$.
    The variable ids must be given in <code class="code">~varid</code> or by a prior call to <a href="Ida.html#VALinit"><code class="code"><span class="constructor">Ida</span>.init</code></a> or
    <a href="Ida.html#VALset_id"><code class="code"><span class="constructor">Ida</span>.set_id</code></a>.
    If given, the <code class="code">~y</code> and <code class="code">~y'</code> vectors are filled with the corrected values.
    The last argument is the first vale of $t$ at which a solution will be
    requested. A <a href="Ida.html#VALreinit"><code class="code"><span class="constructor">Ida</span>.reinit</code></a> is required before calling this function after
    <a href="Ida.html#VALsolve_normal"><code class="code"><span class="constructor">Ida</span>.solve_normal</code></a> or <a href="Ida.html#VALsolve_one_step"><code class="code"><span class="constructor">Ida</span>.solve_one_step</code></a>.<br>
<div class="raisedexceptions"><span class="raises">Raises</span> <code>IdNotSet</code> Variable ids have not been set (see <a href="Ida.html#VALset_id"><code class="code"><span class="constructor">Ida</span>.set_id</code></a>).</div>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:idacalcic">IDACalcIC (IDA_YA_YDP_INIT)</a></div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optin_main">IDASetId</a></div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optout_iccalc">IDAGetConsistentIC</a></div></div>

<pre><span id="VALset_nonlin_conv_coef_ic"><span class="keyword">val</span> set_nonlin_conv_coef_ic</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
Specifies the positive constant in the nonlinear convergence test
    of the initial condition calculation.<br>
<div class="sundials"><span class="seesundials">See sundials: </span>IDASetNonlinConvCoefIC</div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:idacalcic">IDACalcIC</a></div></div>

<pre><span id="VALset_max_num_steps_ic"><span class="keyword">val</span> set_max_num_steps_ic</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
Specifies the maximum number of steps taken in attempting to reach
    a given output time in the initial condition calculation.<br>
<div class="sundials"><span class="seesundials">See sundials: </span>IDASetMaxNumStepsIC</div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:idacalcic">IDACalcIC (IDA_YA_YDP_INIT)</a></div></div>

<pre><span id="VALset_max_num_jacs_ic"><span class="keyword">val</span> set_max_num_jacs_ic</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
Specifies the maximum number of approximate Jacobian or preconditioner
    evaluations allowed when the Newton iteration appears to be slowly
    converging.<br>
<div class="sundials"><span class="seesundials">See sundials: </span>IDASetMaxNumJacsIC</div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:idacalcic">IDACalcIC</a></div></div>

<pre><span id="VALset_max_num_iters_ic"><span class="keyword">val</span> set_max_num_iters_ic</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
Specifies the maximum number of Newton iterations allowed in any one
    attempt to calculate initial conditions.<br>
<div class="sundials"><span class="seesundials">See sundials: </span>IDASetMaxNumItersIC</div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:idacalcic">IDACalcIC</a></div></div>

<pre><span id="VALset_line_search_ic"><span class="keyword">val</span> set_line_search_ic</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> bool -> unit</code></pre><div class="info ">
Enables (<code class="code"><span class="keyword">true</span></code>) or disables (<code class="code"><span class="keyword">false</span></code>) the linesearch algorithm
    in the initial condition calculation.<br>
<div class="sundials"><span class="seesundials">See sundials: </span>IDASetLineSearchOffIC</div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:idacalcic">IDACalcIC</a></div></div>

<pre><span id="VALset_step_tolerance_ic"><span class="keyword">val</span> set_step_tolerance_ic</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
Specifies a positive lower bound on the Newton step in the initial condition
    calculation.<br>
<div class="sundials"><span class="seesundials">See sundials: </span>IDASetStepToleranceIC</div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:idacalcic">IDACalcIC</a></div></div>

<pre><span id="VALget_num_backtrack_ops"><span class="keyword">val</span> get_num_backtrack_ops</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
Returns the number of backtrack operations during <a href="Ida.html#VALcalc_ic_ya_yd'"><code class="code"><span class="constructor">Ida</span>.calc_ic_ya_yd'</code></a> or
    <a href="Ida.html#VALcalc_ic_y"><code class="code"><span class="constructor">Ida</span>.calc_ic_y</code></a>.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optout_iccalc">IDAGetNumBacktrackOps</a></div></div>
<br>
<h2 id="solver">Solution</h2><br>

<pre><code><span id="TYPEsolver_result"><span class="keyword">type</span> <code class="type"></code>solver_result</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsolver_result.Success"><span class="constructor">Success</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The solution was advanced. <span class="cconst">(IDA_SUCCESS)</span><br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsolver_result.RootsFound"><span class="constructor">RootsFound</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
A root was found. See <a href="Ida.html#VALget_root_info"><code class="code"><span class="constructor">Ida</span>.get_root_info</code></a>.
                            <span class="cconst">(IDA_ROOT_RETURN)</span><br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsolver_result.StopTimeReached"><span class="constructor">StopTimeReached</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The stop time was reached. See <a href="Ida.html#VALset_stop_time"><code class="code"><span class="constructor">Ida</span>.set_stop_time</code></a>.
                            <span class="cconst">(IDA_TSTOP_RETURN)</span><br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
Values returned by the step functions. Failures are indicated by
    exceptions.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:ida">IDASolve</a></div></div>


<pre><span id="VALsolve_normal"><span class="keyword">val</span> solve_normal</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -><br>       float -><br>       ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> float * <a href="Ida.html#TYPEsolver_result">solver_result</a></code></pre><div class="info ">
Integrates a DAE system over an interval. The call
    <code class="code">tret, r = solve_normal s tout yout y'out</code> has as arguments<ul>
<li><code class="code">s</code>, a solver session,</li>
<li><code class="code">tout</code> the next time at which the solution is desired,</li>
<li><code class="code">yout</code>, a vector to store the computed solution, and,</li>
<li><code class="code">y'out</code>, a vector to store the computed derivative.</li>
</ul>

    It returns <code class="code">tret</code>, the time reached by the solver, which will be equal to
    <code class="code">tout</code> if no errors occur, and, <code class="code">r</code>, a <a href="Ida.html#TYPEsolver_result"><code class="code"><span class="constructor">Ida</span>.solver_result</code></a>.<br>
<div class="raisedexceptions"><span class="raises">Raises</span><ul><li><code>IllInput</code> Missing or illegal solver inputs.</li>
<li><code>TooMuchWork</code> The requested time could not be reached in <code class="code">mxstep</code> internal steps.</li>
<li><code>TooMuchAccuracy</code> The requested accuracy could not be satisfied.</li>
<li><code>ErrFailure</code> Too many error test failures within a step or at the minimum step size.</li>
<li><code>ConvergenceFailure</code> Too many convergence test failures within a step or at the minimum step size.</li>
<li><code>LinearInitFailure</code> Linear solver initialization failed.</li>
<li><code>LinearSetupFailure</code> Linear solver setup failed unrecoverably.</li>
<li><code>LinearSolveFailure</code> Linear solver solution failed unrecoverably.</li>
<li><code>ConstraintFailure</code> Inequality constraints were violated and recovery is not possible.</li>
<li><code>RepeatedResFuncFailure</code> The residual function repeatedly returned a recoverable error but the solver could not recover.</li>
<li><code>ResFuncFailure</code> The residual function failed unrecoverably.</li>
<li><code>RootFuncFailure</code> Failure in the rootfinding function <code class="code">g</code>.</li>
</ul></div>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:idasolve">IDASolve (IDA_NORMAL)</a></div></div>

<pre><span id="VALsolve_one_step"><span class="keyword">val</span> solve_one_step</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -><br>       float -><br>       ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> float * <a href="Ida.html#TYPEsolver_result">solver_result</a></code></pre><div class="info ">
Like <a href="Ida.html#VALsolve_normal"><code class="code"><span class="constructor">Ida</span>.solve_normal</code></a> but returns after one internal solver step.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:idasolve">IDASolve (IDA_ONE_STEP)</a></div></div>

<pre><span id="VALget_dky"><span class="keyword">val</span> get_dky</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> float -> int -> unit</code></pre><div class="info ">
Returns the interpolated solution or derivatives.
    <code class="code">get_dky s dky t k</code> computes the <code class="code">k</code>th derivative of the function at time
    <code class="code">t</code>, i.e., $\frac{d^\mathtt{k}y(\mathtt{t})}{\mathit{dt}^\mathtt{k}}$,
    and stores it in <code class="code">dky</code>. The arguments must satisfy
    $t_n - h_u \leq \mathtt{t} \leq t_n$—where $t_n$
    denotes <a href="Ida.html#VALget_current_time"><code class="code"><span class="constructor">Ida</span>.get_current_time</code></a> and $h_u$ denotes <a href="Ida.html#VALget_last_step"><code class="code"><span class="constructor">Ida</span>.get_last_step</code></a>,—
    and $0 \leq \mathtt{k} \leq q_u$—where $q_u$ denotes
    <a href="Ida.html#VALget_last_order"><code class="code"><span class="constructor">Ida</span>.get_last_order</code></a>.
<p>

    This function may only be called after a successful return from either
    <a href="Ida.html#VALsolve_normal"><code class="code"><span class="constructor">Ida</span>.solve_normal</code></a> or <a href="Ida.html#VALsolve_one_step"><code class="code"><span class="constructor">Ida</span>.solve_one_step</code></a>.<br>
<div class="raisedexceptions"><span class="raises">Raises</span><ul><li><code>BadT</code> <code class="code">t</code> is not in the interval $[t_n - h_u, t_n]$.</li>
<li><code>BadK</code> <code class="code">k</code> is not in the range 0, 1, ..., $q_u$.</li>
</ul></div>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optin_root">IDAGetDky</a></div></div>

<pre><span id="VALreinit"><span class="keyword">val</span> reinit</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -><br>       ?linsolv:('d, 'k) <a href="Ida.html#TYPElinear_solver">linear_solver</a> -><br>       ?roots:int * 'd <a href="Ida.html#TYPErootsfn">rootsfn</a> -><br>       float -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> unit</code></pre><div class="info ">
Reinitializes the solver with new parameters and state values. The
    values of the independent variable, i.e., the simulation time, the
    state variables, and the derivatives must be given.
    If the argument <code class="code">~linsolv</code> is not given, the current linear solver
    remains unchanged. The argument <code class="code">~roots</code> works similarly; pass
    <a href="Ida.html#VALno_roots"><code class="code"><span class="constructor">Ida</span>.no_roots</code></a> to disable root finding.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:cvreinit">IDAReInit</a></div></div>
<br>
<h2 id="set">Modifying the solver (optional input functions)</h2><br>

<pre><span id="VALset_tolerances"><span class="keyword">val</span> set_tolerances</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> ('d, 'k) <a href="Ida.html#TYPEtolerance">tolerance</a> -> unit</code></pre><div class="info ">
Set the integration tolerances.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:idatolerances">IDASStolerances</a></div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:idatolerances">IDASVtolerances</a></div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:idatolerances">IDAWFtolerances</a></div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:ewtsetFn">      IDAEwtFn</a></div></div>

<pre><span id="VALset_error_file"><span class="keyword">val</span> set_error_file</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> string -> bool -> unit</code></pre><div class="info ">
Opens the named file to receive messages from the default error handler.
    If the file already exists it is either truncated (<code class="code"><span class="keyword">true</span></code>) or extended
    (<code class="code"><span class="keyword">false</span></code>).
    The file is closed if the function is called again or when the session is
    garbage collected.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optin_main">IDASetErrFile</a></div></div>

<pre><span id="VALset_err_handler_fn"><span class="keyword">val</span> set_err_handler_fn</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> (<a href="Sundials.html#TYPEerror_details">Sundials.error_details</a> -> unit) -> unit</code></pre><div class="info ">
Specifies a custom function for handling error messages.
    The handler must not fail: any exceptions are trapped and discarded.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optin_main">IDASetErrHandlerFn</a></div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:ehFn">IDAErrHandlerFn</a></div></div>

<pre><span id="VALclear_err_handler_fn"><span class="keyword">val</span> clear_err_handler_fn</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
Restores the default error handling function.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optin_main">IDASetErrHandlerFn</a></div></div>

<pre><span id="VALset_max_ord"><span class="keyword">val</span> set_max_ord</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
Specifies the maximum order of the linear multistep method.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optin_main">IDASetMaxOrd</a></div></div>

<pre><span id="VALset_max_num_steps"><span class="keyword">val</span> set_max_num_steps</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
Specifies the maximum number of steps taken in attempting to reach
    a given output time.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optin_main">IDASetMaxNumSteps</a></div></div>

<pre><span id="VALset_init_step"><span class="keyword">val</span> set_init_step</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
Specifies the initial step size.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optin_main">IDASetInitStep</a></div></div>

<pre><span id="VALset_max_step"><span class="keyword">val</span> set_max_step</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
Specifies an upper bound on the magnitude of the step size.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optin_main">IDASetMaxStep</a></div></div>

<pre><span id="VALset_stop_time"><span class="keyword">val</span> set_stop_time</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
Limits the value of the independent variable <code class="code">t</code> when solving.
    By default no stop time is imposed.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optin_main">IDASetStopTime</a></div></div>

<pre><span id="VALset_max_err_test_fails"><span class="keyword">val</span> set_max_err_test_fails</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
Specifies the maximum number of error test failures permitted in attempting
    one step.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optin_main">IDASetMaxErrTestFails</a></div></div>

<pre><span id="VALset_max_nonlin_iters"><span class="keyword">val</span> set_max_nonlin_iters</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
Specifies the maximum number of nonlinear solver iterations permitted per
    step.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optin_main">IDASetMaxNonlinIters</a></div></div>

<pre><span id="VALset_max_conv_fails"><span class="keyword">val</span> set_max_conv_fails</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
Specifies the maximum number of nonlinear solver convergence failures
    permitted during one step.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optin_main">IDASetMaxConvFails</a></div></div>

<pre><span id="VALset_nonlin_conv_coef"><span class="keyword">val</span> set_nonlin_conv_coef</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
Specifies the safety factor used in the nonlinear convergence test.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optin_main">IDASetNonlinConvCoef</a></div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node3.html#ss:ivp_sol">IVP Solution</a></div></div>

<pre><span id="VALset_constraints"><span class="keyword">val</span> set_constraints</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> unit</code></pre><div class="info ">
Specifies a vector defining inequality constraints for each
    component of the solution vector <code class="code">u</code>.  See <a href="Sundials.Constraint.html"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">Constraint</span></code></a>.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optin_main">IDASetConstraints</a></div></div>
<br>
<h2 id="get">Querying the solver (optional output functions)</h2><br>

<pre><span id="VALget_work_space"><span class="keyword">val</span> get_work_space</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> int * int</code></pre><div class="info ">
Returns the sizes of the real and integer workspaces.<br>
<b>Returns</b> (<code class="code">real_size</code>, <code class="code">integer_size</code>)<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optout_main">IDAGetWorkSpace</a></div></div>

<pre><span id="VALget_num_steps"><span class="keyword">val</span> get_num_steps</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
Returns the cumulative number of internal solver steps.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optout_main">IDAGetNumSteps</a></div></div>

<pre><span id="VALget_num_res_evals"><span class="keyword">val</span> get_num_res_evals</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
Returns the number of calls to the residual function.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optout_main">IDAGetNumResEvals</a></div></div>

<pre><span id="VALget_num_lin_solv_setups"><span class="keyword">val</span> get_num_lin_solv_setups</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
Returns the number of calls made to the linear solver's setup function.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optout_main">IDAGetNumLinSolvSetups</a></div></div>

<pre><span id="VALget_num_err_test_fails"><span class="keyword">val</span> get_num_err_test_fails</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
Returns the number of local error test failures that have occurred.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optout_main">IDAGetNumErrTestFails</a></div></div>

<pre><span id="VALget_last_order"><span class="keyword">val</span> get_last_order</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
Returns the integration method order used during the last internal step.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optout_main">IDAGetLastOrder</a></div></div>

<pre><span id="VALget_current_order"><span class="keyword">val</span> get_current_order</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
Returns the integration method order to be used on the next internal step.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optout_main">IDAGetCurrentOrder</a></div></div>

<pre><span id="VALget_last_step"><span class="keyword">val</span> get_last_step</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
Returns the integration step size taken on the last internal step.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optout_main">IDAGetLastStep</a></div></div>

<pre><span id="VALget_current_step"><span class="keyword">val</span> get_current_step</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
Returns the integration step size to be attempted on the next internal step.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optout_main">IDAGetCurrentStep</a></div></div>

<pre><span id="VALget_actual_init_step"><span class="keyword">val</span> get_actual_init_step</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
Returns the the value of the integration step size used on the first step.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optout_main">IDAGetActualInitStep</a></div></div>

<pre><span id="VALget_current_time"><span class="keyword">val</span> get_current_time</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
Returns the the current internal time reached by the solver.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optout_main">IDAGetCurrentTime</a></div></div>

<pre><span id="VALget_tol_scale_factor"><span class="keyword">val</span> get_tol_scale_factor</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
Returns a suggested factor by which the user's tolerances should be scaled
    when too much accuracy has been requested for some internal step.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optout_main">IDAGetTolScaleFactor</a></div></div>

<pre><span id="VALget_err_weights"><span class="keyword">val</span> get_err_weights</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> unit</code></pre><div class="info ">
Returns the solution error weights at the current time.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optout_main">IDAGetErrWeights</a></div><div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node3.html#ss:ivp_sol">IVP solution (W_i)</a></div></div>

<pre><span id="VALget_est_local_errors"><span class="keyword">val</span> get_est_local_errors</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> unit</code></pre><div class="info ">
Returns the vector of estimated local errors.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optout_main">IDAGetEstLocalErrors</a></div></div>

<pre><code><span id="TYPEintegrator_stats"><span class="keyword">type</span> <code class="type"></code>integrator_stats</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.num_steps">num_steps</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Cumulative number of internal solver steps.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.num_res_evals">num_res_evals</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Number of calls to the residual function.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.num_lin_solv_setups">num_lin_solv_setups</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Number of setups calls to the linear solver.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.num_err_test_fails">num_err_test_fails</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Number of local error test failures.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.last_order">last_order</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Integration method order used in the last internal step.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.current_order">current_order</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Integration method order to be used in the next internal step.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.actual_init_step">actual_init_step</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Integration step sized used on the first step.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.last_step">last_step</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Integration step size of the last internal step.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.current_step">current_step</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Integration step size to attempt on the next internal step.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.current_time">current_time</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Current internal time reached by the solver.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
}

<div class="info ">
Summaries of integrator statistics.<br>
</div>


<pre><span id="VALget_integrator_stats"><span class="keyword">val</span> get_integrator_stats</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> <a href="Ida.html#TYPEintegrator_stats">integrator_stats</a></code></pre><div class="info ">
Returns the integrator statistics as a group.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optout_main">IDAGetIntegratorStats</a></div></div>

<pre><span id="VALprint_integrator_stats"><span class="keyword">val</span> print_integrator_stats</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> Pervasives.out_channel -> unit</code></pre><div class="info ">
Prints the integrator statistics on the given channel.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optout_main">IDAGetIntegratorStats</a></div></div>

<pre><span id="VALget_num_nonlin_solv_iters"><span class="keyword">val</span> get_num_nonlin_solv_iters</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
Returns the number of nonlinear (functional or Newton) iterations performed.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optout_main">IDAGetNumNonlinSolvIters</a></div></div>

<pre><span id="VALget_num_nonlin_solv_conv_fails"><span class="keyword">val</span> get_num_nonlin_solv_conv_fails</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
Returns the number of nonlinear convergence failures that have occurred.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optout_main">IDAGetNumNonlinSolvConvFails</a></div></div>

<pre><span id="VALget_nonlin_solv_stats"><span class="keyword">val</span> get_nonlin_solv_stats</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> int * int</code></pre><div class="info ">
Returns both the numbers of nonlinear iterations performed <code class="code">nniters</code> and
    nonlinear convergence failures <code class="code">nncfails</code>.<br>
<b>Returns</b> (<code class="code">nniters</code>, <code class="code">nncfails</code>)<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optout_main">IDAGetNonlinSolvStats</a></div></div>
<br>
<h2 id="roots">Additional root-finding functions</h2><br>

<pre><span id="VALset_root_direction"><span class="keyword">val</span> set_root_direction</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> <a href="Sundials.RootDirs.html#TYPEd">Sundials.RootDirs.d</a> array -> unit</code></pre><div class="info ">
<code class="code">set_root_direction s dir</code> specifies the direction of zero-crossings to be
    located and returned. <code class="code">dir</code> may contain one entry for each root function.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optin_root">IDASetRootDirection</a></div></div>

<pre><span id="VALset_all_root_directions"><span class="keyword">val</span> set_all_root_directions</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> <a href="Sundials.RootDirs.html#TYPEd">Sundials.RootDirs.d</a> -> unit</code></pre><div class="info ">
Like <a href="Ida.html#VALset_root_direction"><code class="code"><span class="constructor">Ida</span>.set_root_direction</code></a> but specifies a single direction for all root
    functions.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optin_root">IDASetRootDirection</a></div></div>

<pre><span id="VALset_no_inactive_root_warn"><span class="keyword">val</span> set_no_inactive_root_warn</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
Disables issuing a warning if some root function appears to be identically
    zero at the beginning of the integration.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optin_root">IDASetNoInactiveRootWarn</a></div></div>

<pre><span id="VALget_num_roots"><span class="keyword">val</span> get_num_roots</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
Returns the number of root functions.<br>
</div>

<pre><span id="VALget_root_info"><span class="keyword">val</span> get_root_info</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> <a href="Sundials.Roots.html#TYPEt">Sundials.Roots.t</a> -> unit</code></pre><div class="info ">
Fills an array showing which functions were found to have a root.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optout_root">IDAGetRootInfo</a></div></div>

<pre><span id="VALget_num_g_evals"><span class="keyword">val</span> get_num_g_evals</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
Returns the cumulative number of calls made to the user-supplied root
    function g.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:optout_root">IDAGetNumGEvals</a></div></div>
<br>
<h2 id="exceptions">Exceptions</h2><br>

<pre><span id="EXCEPTIONIllInput"><span class="keyword">exception</span> IllInput</span></pre>
<div class="info ">
Raised on missing or illegal solver inputs. Also raised if an element
    of the error weight vector becomes zero during time stepping, or the
    linear solver initialization function failed, or a root was found both at
    <code class="code">t</code> and very near <code class="code">t</code>.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:idasolve">IDA_ILL_INPUT</a></div></div>

<pre><span id="EXCEPTIONTooMuchWork"><span class="keyword">exception</span> TooMuchWork</span></pre>
<div class="info ">
The requested time could not be reached in <code class="code">mxstep</code> internal steps.
    See <a href="Ida.html#VALset_max_num_steps"><code class="code"><span class="constructor">Ida</span>.set_max_num_steps</code></a><br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:idasolve">IDA_TOO_MUCH_WORK</a></div></div>

<pre><span id="EXCEPTIONTooMuchAccuracy"><span class="keyword">exception</span> TooMuchAccuracy</span></pre>
<div class="info ">
The requested accuracy could not be satisfied.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:idasolve">IDA_TOO_MUCH_ACC</a></div></div>

<pre><span id="EXCEPTIONErrFailure"><span class="keyword">exception</span> ErrFailure</span></pre>
<div class="info ">
Too many error test failures within a step. See <a href="Ida.html#VALset_max_err_test_fails"><code class="code"><span class="constructor">Ida</span>.set_max_err_test_fails</code></a>.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:idasolve">IDA_ERR_FAIL</a></div></div>

<pre><span id="EXCEPTIONConvergenceFailure"><span class="keyword">exception</span> ConvergenceFailure</span></pre>
<div class="info ">
Too many convergence test failures within a step,
    or Newton convergence failed. See <a href="Ida.html#VALset_max_conv_fails"><code class="code"><span class="constructor">Ida</span>.set_max_conv_fails</code></a>.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:idasolve">IDA_CONV_FAIL</a></div></div>

<pre><span id="EXCEPTIONLinearInitFailure"><span class="keyword">exception</span> LinearInitFailure</span></pre>
<div class="info ">
Linear solver initialization failed.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:idasolve">IDA_LINIT_FAIL</a></div></div>

<pre><span id="EXCEPTIONLinearSetupFailure"><span class="keyword">exception</span> LinearSetupFailure</span></pre>
<div class="info ">
Linear solver setup failed in an unrecoverable manner.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:idasolve">IDA_LSETUP_FAIL</a></div></div>

<pre><span id="EXCEPTIONLinearSolveFailure"><span class="keyword">exception</span> LinearSolveFailure</span></pre>
<div class="info ">
Linear solver solution failed in an unrecoverable manner.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:idasolve">IDA_LSOLVE_FAIL</a></div></div>

<pre><span id="EXCEPTIONResFuncFailure"><span class="keyword">exception</span> ResFuncFailure</span></pre>
<div class="info ">
The residual function failed in an unrecoverable manner.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:idasolve">IDA_RES_FAIL</a></div></div>

<pre><span id="EXCEPTIONFirstResFuncFailure"><span class="keyword">exception</span> FirstResFuncFailure</span></pre>
<div class="info ">
The residual function had a recoverable error when first called.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:idacalcic">IDA_FIRST_RES_FAIL</a></div></div>

<pre><span id="EXCEPTIONRepeatedResFuncFailure"><span class="keyword">exception</span> RepeatedResFuncFailure</span></pre>
<div class="info ">
Too many convergence test failures, or unable to estimate the initial step
    size, due to repeated recoverable errors in the residual function.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:idasolve">IDA_REP_RES_ERR</a></div></div>

<pre><span id="EXCEPTIONRootFuncFailure"><span class="keyword">exception</span> RootFuncFailure</span></pre>
<div class="info ">
The rootfinding function failed.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#sss:idasolve">IDA_RTFUNC_FAIL</a></div></div>

<pre><span id="EXCEPTIONConstraintFailure"><span class="keyword">exception</span> ConstraintFailure</span></pre>
<div class="info ">
No solution satisfying the inequality constraints could be found.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:idacalcic">IDA_CONSTR_FAIL</a></div></div>

<pre><span id="EXCEPTIONLinesearchFailure"><span class="keyword">exception</span> LinesearchFailure</span></pre>
<div class="info ">
Linesearch could not find a solution with a step larger than steptol in
    weighted RMS norm.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:idacalcic">IDA_LINESEARCH_FAIL</a></div></div>

<pre><span id="EXCEPTIONNoRecovery"><span class="keyword">exception</span> NoRecovery</span></pre>
<div class="info ">
A recoverable error occurred in a callback but no recovery was possible.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:idacalcic">IDA_NO_RECOVERY</a></div></div>

<pre><span id="EXCEPTIONBadEwt"><span class="keyword">exception</span> BadEwt</span></pre>
<div class="info ">
A component of the error weight vector, either for the input value or a
    corrected value, is zero.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:idacalcic">IDA_BAD_EWT</a></div></div>

<pre><span id="EXCEPTIONBadK"><span class="keyword">exception</span> BadK</span></pre>
<div class="info ">
Raised by <a href="Ida.html#VALget_dky"><code class="code"><span class="constructor">Ida</span>.get_dky</code></a> for invalid order values.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:optional_dky">IDAGetDky (IDA_BAD_K)</a></div></div>

<pre><span id="EXCEPTIONBadT"><span class="keyword">exception</span> BadT</span></pre>
<div class="info ">
Raised by <a href="Ida.html#VALget_dky"><code class="code"><span class="constructor">Ida</span>.get_dky</code></a> for invalid time values.<br>
<div class="sundials ida"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ida_guide/node5.html#ss:optional_dky">IDAGetDky (IDA_BAD_T)</a></div></div>

<pre><span id="EXCEPTIONIdNotSet"><span class="keyword">exception</span> IdNotSet</span></pre>
<div class="info ">
Variable ids are required but not set. See <a href="Ida.html#VALset_id"><code class="code"><span class="constructor">Ida</span>.set_id</code></a>.<br>
</div>
</body></html>