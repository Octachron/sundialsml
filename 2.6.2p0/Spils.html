<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="docstyle.css" type="text/css">
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});
</script><script type="text/javascript"
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link rel="previous" href="Sls.html">
<link rel="next" href="Nvector_custom.html">
<link rel="Up" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Sundials" rel="Chapter" href="Sundials.html">
<link title="Nvector" rel="Chapter" href="Nvector.html">
<link title="Dls" rel="Chapter" href="Dls.html">
<link title="Sls" rel="Chapter" href="Sls.html">
<link title="Spils" rel="Chapter" href="Spils.html">
<link title="Nvector_custom" rel="Chapter" href="Nvector_custom.html">
<link title="Nvector_array" rel="Chapter" href="Nvector_array.html">
<link title="Nvector_serial" rel="Chapter" href="Nvector_serial.html">
<link title="Cvode" rel="Chapter" href="Cvode.html">
<link title="Kinsol" rel="Chapter" href="Kinsol.html">
<link title="Ida" rel="Chapter" href="Ida.html">
<link title="Arkode" rel="Chapter" href="Arkode.html">
<link title="Cvodes" rel="Chapter" href="Cvodes.html">
<link title="Idas" rel="Chapter" href="Idas.html">
<link title="Nvector_parallel" rel="Chapter" href="Nvector_parallel.html">
<link title="Kinsol_bbd" rel="Chapter" href="Kinsol_bbd.html">
<link title="Arkode_bbd" rel="Chapter" href="Arkode_bbd.html">
<link title="Cvode_bbd" rel="Chapter" href="Cvode_bbd.html">
<link title="Cvodes_bbd" rel="Chapter" href="Cvodes_bbd.html">
<link title="Ida_bbd" rel="Chapter" href="Ida_bbd.html">
<link title="Idas_bbd" rel="Chapter" href="Idas_bbd.html">
<link title="Nvector_openmp" rel="Chapter" href="Nvector_openmp.html">
<link title="Nvector_pthreads" rel="Chapter" href="Nvector_pthreads.html"><link title="Types" rel="Section" href="#2_Types">
<link title="Exceptions" rel="Section" href="#2_Exceptions">
<link title="Basic routines" rel="Section" href="#2_Basicroutines">
<link title="Solvers" rel="Section" href="#2_Solvers">
<title>Sundials/ML 2.6.2p0 : Spils</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Sls.html" title="Sls">Previous</a>
&nbsp;<a class="up" href="index.html" title="Index">Up</a>
&nbsp;<a class="post" href="Nvector_custom.html" title="Nvector_custom">Next</a>
</div>
<h1>Module <a href="type_Spils.html">Spils</a></h1>

<pre><span class="keyword">module</span> Spils: <code class="code"><span class="keyword">sig</span></code> <a href="Spils.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info module top">
Scaled Preconditioned Iterative Linear Solvers routines.
<p>

    Global constants and general purpose solver routines.<br>
<div class="authors"><b>Author(s):</b> Timothy Bourke (Inria/ENS), Jun Inoue (Inria/ENS), Marc Pouzet (UPMC/ENS/Inria)</div>
<b>Version:</b> 2.6.2<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node9.html#s:spils"> The SPILS Modules</a></div></div>
<hr width="100%">
<br>
<h2 id="2_Types">Types</h2><br>

<pre><code><span id="TYPEgramschmidt_type"><span class="keyword">type</span> <code class="type"></code>gramschmidt_type</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTgramschmidt_type.ModifiedGS"><span class="constructor">ModifiedGS</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Modified Gram-Schmidt orthogonalization
                     <span class="cconst">(MODIFIED_GS)</span><br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTgramschmidt_type.ClassicalGS"><span class="constructor">ClassicalGS</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Classical Gram Schmidt orthogonalization
                     <span class="cconst">(CLASSICAL_GS)</span><br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
The type of Gram-Schmidt orthogonalization in SPGMR linear solvers.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node9.html#ss:spgmr">ModifiedGS/ClassicalGS</a></div></div>


<pre><code><span id="TYPEpreconditioning_type"><span class="keyword">type</span> <code class="type"></code>preconditioning_type</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTpreconditioning_type.PrecNone"><span class="constructor">PrecNone</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
No preconditioning<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTpreconditioning_type.PrecLeft"><span class="constructor">PrecLeft</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
$(P^{-1}A)x = P^{-1}b$ <br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTpreconditioning_type.PrecRight"><span class="constructor">PrecRight</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
$(AP^{-1})Px = b$ <br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTpreconditioning_type.PrecBoth"><span class="constructor">PrecBoth</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
$(P_L^{-1}AP_R^{-1})P_Rx = P_L^{-1}b$ <br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
The type of preconditioning in Krylov solvers.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node3.html#s:preconditioning">Preconditioning</a></div><div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:lin_solv_init">CVSpgmr/CVSpbcg/CVSptfqrm</a></div></div>

<br>
<h2 id="2_Exceptions">Exceptions</h2><br>

<pre><span id="EXCEPTIONZeroDiagonalElement"><span class="keyword">exception</span> ZeroDiagonalElement</span> <span class="keyword">of</span> <code class="type">int</code></pre>
<div class="info ">
Raised by <a href="Spils.html#VALqr_fact"><code class="code"><span class="constructor">Spils</span>.qr_fact</code></a> and <a href="Spils.html#VALqr_sol"><code class="code"><span class="constructor">Spils</span>.qr_sol</code></a> on a zero diagonal element during
    factorization. The argument gives the equation number (from 1).<br>
</div>

<pre><span id="EXCEPTIONConvFailure"><span class="keyword">exception</span> ConvFailure</span></pre>
<div class="info ">
Raised when a solver fails to converge.
    <span class="cconst">(*_CONVFAIL)</span><br>
</div>

<pre><span id="EXCEPTIONQRfactFailure"><span class="keyword">exception</span> QRfactFailure</span></pre>
<div class="info ">
Raised when QR factorization yields a singular matrix.
    <span class="cconst">(*_SPTFQMR_QRFACT_FAIL)</span><br>
</div>

<pre><span id="EXCEPTIONPSolveFailure"><span class="keyword">exception</span> PSolveFailure</span> <span class="keyword">of</span> <code class="type">bool</code></pre>
<div class="info ">
Raised when a preconditioner solver fails. The argument is <code class="code"><span class="keyword">true</span></code> for a
    recoverable failure and <code class="code"><span class="keyword">false</span></code> for an unrecoverable one.
    <span class="cconst">(*_PSOLVE_FAIL_REC/_UNREC)</span><br>
</div>

<pre><span id="EXCEPTIONATimesFailure"><span class="keyword">exception</span> ATimesFailure</span> <span class="keyword">of</span> <code class="type">bool</code></pre>
<div class="info ">
Raised when an atimes function fails. The argument is <code class="code"><span class="keyword">true</span></code> for a
    recoverable failure and <code class="code"><span class="keyword">false</span></code> for an unrecoverable one.
    <span class="cconst">(*_ATIMES_FAIL_REC/_UNREC)</span><br>
</div>

<pre><span id="EXCEPTIONPSetFailure"><span class="keyword">exception</span> PSetFailure</span> <span class="keyword">of</span> <code class="type">bool</code></pre>
<div class="info ">
Raised when a preconditioner setup routine fails. The argument is <code class="code"><span class="keyword">true</span></code>
    for a recoverable failure and <code class="code"><span class="keyword">false</span></code> for an unrecoverable one.
    <span class="cconst">(*_PSET_FAIL_REC/_UNREC)</span><br>
</div>

<pre><span id="EXCEPTIONGSFailure"><span class="keyword">exception</span> GSFailure</span></pre>
<div class="info ">
Raised when a Gram-Schmidt routine fails. <span class="cconst">(*_GS_FAIL)</span><br>
</div>

<pre><span id="EXCEPTIONQRSolFailure"><span class="keyword">exception</span> QRSolFailure</span></pre>
<div class="info ">
Raised QR solution finds a singular result. <span class="cconst">(*_QRSOL_FAIL)</span><br>
</div>
<br>
<h2 id="2_Basicroutines">Basic routines</h2><br>

<pre><span id="VALqr_fact"><span class="keyword">val</span> qr_fact</span> : <code class="type"><a href="Sundials.RealArray2.html#TYPEt">Sundials.RealArray2.t</a> -> <a href="Sundials.RealArray.html#TYPEt">Sundials.RealArray.t</a> -> bool -> unit</code></pre><div class="info ">
Performs a QR factorization of a Hessenberg matrix.
    The call <code class="code">qr_fact h q newjob</code>, where <code class="code">h</code> is the <code class="code">n+1</code> by <code class="code">n</code>
    Hessenberg matrix (stored row-wise), <code class="code">q</code> stores the computed Givens
    rotation, and <code class="code">newjob=<span class="keyword">false</span></code> indicates that the first <code class="code">n-1</code> columns of
    <code class="code">h</code> have already been factored. The computed Givens rotation has the form
    $\begin{bmatrix} c & -s \\ s & c \end{bmatrix}$ . It is stored in
    the <code class="code">2n</code> elements of <code class="code">q</code> as <code class="code">[|c; s; c; s; ...; c; s|]</code>.<br>
<div class="raisedexceptions"><span class="raises">Raises</span> <code>ZeroDiagonalElement</code> Zero found in matrix diagonal</div>
</div>

<pre><span id="VALqr_sol"><span class="keyword">val</span> qr_sol</span> : <code class="type"><a href="Sundials.RealArray2.html#TYPEt">Sundials.RealArray2.t</a> -> <a href="Sundials.RealArray.html#TYPEt">Sundials.RealArray.t</a> -> <a href="Sundials.RealArray.html#TYPEt">Sundials.RealArray.t</a> -> unit</code></pre><div class="info ">
Solve the linear least squares problem. In
    <code class="code">qr_sol h q b</code>, <code class="code">h</code> and <code class="code">q</code> are, respectively, the upper triangular
    factor $R$ of the original Hessenberg matrix and <code class="code"><span class="constructor">Q</span></code> the Givens
    rotations used to factor it—both computed by <a href="Spils.html#VALqr_fact"><code class="code"><span class="constructor">Spils</span>.qr_fact</code></a>. The function
    computes the <code class="code">n+1</code> elements of <code class="code">b</code> to solve $Rx = Qb$.<br>
<div class="raisedexceptions"><span class="raises">Raises</span> <code>ZeroDiagonalElement</code> Zero found in matrix diagonal</div>
</div>

<pre><span id="VALmodified_gs"><span class="keyword">val</span> modified_gs</span> : <code class="type">('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -> <a href="Sundials.RealArray2.html#TYPEt">Sundials.RealArray2.t</a> -> int -> int -> float</code></pre><div class="info ">
Performs a modified Gram-Schmidt orthogonalization. In
    <code class="code">modified_gs v h k p</code>,<ul>
<li><code class="code">v</code> is an array of at least <code class="code">k + 1</code> vectors with an L2-norm of 1,</li>
<li><code class="code">h</code> is the output <code class="code">k</code> by <code class="code">k</code> Hessenberg matrix of inner products,</li>
<li><code class="code">k</code> specifies the vector in <code class="code">v</code> to be orthogonalized against previous ones,
        and,</li>
<li><code class="code">p</code> is the number of previous vectors in <code class="code">v</code> to orthogonalize against.    </li>
</ul>

  The vector <code class="code">v[k]</code> is orthogonalized against the <code class="code">p</code> unit vectors at
  <code class="code">v.{k-1}</code>, <code class="code">v.{k-2}</code>, ..., <code class="code">v.{k-p}</code>.
  The matrix <code class="code">h</code> must be allocated row-wise so that the <code class="code">(i,j)</code>th entry is
  <code class="code">h.{i}.{j}</code>.
  The inner products are computed, $\mathtt{h.\{}i\mathtt{, k-1\}} =
    \mathtt{v.\{}i\mathtt{\}} \cdot \mathtt{v.\{k\}}$ , for
  $i=\max(0, \mathtt{k}-\mathtt{p})\ldots \mathtt{k}-1$ .
  The orthogonalized <code class="code">v.{k}</code> is <b>not</b> normalized and is stored over the old
  <code class="code">v.{k}</code>. The function returns the Euclidean norm of the orthogonalized
  vector.<br>
</div>

<pre><span id="VALclassical_gs"><span class="keyword">val</span> classical_gs</span> : <code class="type">('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -><br>       <a href="Sundials.RealArray2.html#TYPEt">Sundials.RealArray2.t</a> -><br>       int -> int -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> <a href="Sundials.RealArray.html#TYPEt">Sundials.RealArray.t</a> -> float</code></pre><div class="info ">
Performs a classical Gram-Schmidt orthogonalization. In
    <code class="code">classical_gs v h k p temp s</code>,<ul>
<li><code class="code">v</code> is an array of at least <code class="code">k + 1</code> vectors with an L2-norm of 1,</li>
<li><code class="code">h</code> is the output <code class="code">k</code> by <code class="code">k</code> Hessenberg matrix of inner products,</li>
<li><code class="code">k</code> specifies the vector in <code class="code">v</code> to be orthogonalized against previous ones,
        and,</li>
<li><code class="code">p</code> is the number of previous vectors in <code class="code">v</code> to orthogonalize against.    </li>
<li><code class="code">temp</code> and <code class="code">s</code> are used as workspaces.</li>
</ul>

  The vector <code class="code">v[k]</code> is orthogonalized against the <code class="code">p</code> unit vectors at
  <code class="code">v.{k-1}</code>, <code class="code">v.{k-2}</code>, ..., <code class="code">v.{k-p}</code>.
  The matrix <code class="code">h</code> must be allocated row-wise so that the <code class="code">(i,j)</code>th entry is
  <code class="code">h.{i}.{j}</code>.
  The inner products are computed, $\mathtt{h.\{}i\mathtt{, k-1\}} =
    \mathtt{v.\{}i\mathtt{\}} \cdot \mathtt{v.\{k\}}$ , for
  $i=\max(0, \mathtt{k}-\mathtt{p})\ldots \mathtt{k}-1$ .
  The orthogonalized <code class="code">v.{k}</code> is <b>not</b> normalized and is stored over the old
  <code class="code">v.{k}</code>. The function returns the Euclidean norm of the orthogonalized
  vector.<br>
</div>
<br>
<h2 id="2_Solvers">Solvers</h2><br>

<pre><span id="TYPEatimes"><span class="keyword">type</span> <code class="type">'d</code> atimes</span> = <code class="type">'d -> 'd -> unit</code> </pre>
<div class="info ">
Functions <code class="code">f v z</code> that calculate <code class="code">z = <span class="constructor">A</span> v</code> using an internal
    representation of <code class="code"><span class="constructor">A</span></code>. Results are stored in <code class="code">z</code>, <code class="code">v</code> must not be changed.
    Raise <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> to indicate a recoverable failure,
    any other exception indicates an unrecoverable failure.<br>
</div>


<pre><span id="TYPEpsolve"><span class="keyword">type</span> <code class="type">'d</code> psolve</span> = <code class="type">'d -> 'd -> bool -> unit</code> </pre>
<div class="info ">
Functions <code class="code">f r z lr</code> that solve the preconditioner equation <code class="code"><span class="constructor">P</span> z = r</code> for
    the vector <code class="code">z</code>. If <code class="code">lr = <span class="keyword">true</span></code> then <code class="code"><span class="constructor">P</span></code> is used as a left preconditioner
    and otherwise as a right preconditioner.
    Raise <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> to indicate a recoverable failure,
    any other exception indicates an unrecoverable failure.<br>
</div>


<pre><span class="keyword">module</span> <a href="Spils.SPGMR.html">SPGMR</a>: <code class="code"><span class="keyword">sig</span></code> <a href="Spils.SPGMR.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
The Scaled Preconditioned Generalized Minimum Residual (GMRES) method.
</div>

<pre><span class="keyword">module</span> <a href="Spils.SPFGMR.html">SPFGMR</a>: <code class="code"><span class="keyword">sig</span></code> <a href="Spils.SPFGMR.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
The Scaled Preconditioned Flexible Generalized Minimum Residual (GMRES)
    method.
</div>

<pre><span class="keyword">module</span> <a href="Spils.SPBCG.html">SPBCG</a>: <code class="code"><span class="keyword">sig</span></code> <a href="Spils.SPBCG.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
The Scaled Preconditioned Biconjugate Gradient Stabilized (Bi-CGStab)
    method.
</div>

<pre><span class="keyword">module</span> <a href="Spils.SPTFQMR.html">SPTFQMR</a>: <code class="code"><span class="keyword">sig</span></code> <a href="Spils.SPTFQMR.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
The Scaled Preconditioned Transpose-Free Quasi-Minimal Residual
    (SPTFQMR) method
</div>

<pre><span class="keyword">module</span> <a href="Spils.PCG.html">PCG</a>: <code class="code"><span class="keyword">sig</span></code> <a href="Spils.PCG.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
The Preconditioned Conjugate-Gradient (PCG) method.
</div>
</body></html>