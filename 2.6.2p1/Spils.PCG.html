<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="docstyle.css" type="text/css">
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});
</script><script type="text/javascript"
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link rel="previous" href="Spils.SPTFQMR.html">
<link rel="Up" href="Spils.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Sundials" rel="Chapter" href="Sundials.html">
<link title="Nvector" rel="Chapter" href="Nvector.html">
<link title="Dls" rel="Chapter" href="Dls.html">
<link title="Sls" rel="Chapter" href="Sls.html">
<link title="Spils" rel="Chapter" href="Spils.html">
<link title="Nvector_custom" rel="Chapter" href="Nvector_custom.html">
<link title="Nvector_array" rel="Chapter" href="Nvector_array.html">
<link title="Nvector_serial" rel="Chapter" href="Nvector_serial.html">
<link title="Cvode" rel="Chapter" href="Cvode.html">
<link title="Kinsol" rel="Chapter" href="Kinsol.html">
<link title="Ida" rel="Chapter" href="Ida.html">
<link title="Arkode" rel="Chapter" href="Arkode.html">
<link title="Cvodes" rel="Chapter" href="Cvodes.html">
<link title="Idas" rel="Chapter" href="Idas.html">
<link title="Nvector_parallel" rel="Chapter" href="Nvector_parallel.html">
<link title="Kinsol_bbd" rel="Chapter" href="Kinsol_bbd.html">
<link title="Arkode_bbd" rel="Chapter" href="Arkode_bbd.html">
<link title="Cvode_bbd" rel="Chapter" href="Cvode_bbd.html">
<link title="Cvodes_bbd" rel="Chapter" href="Cvodes_bbd.html">
<link title="Ida_bbd" rel="Chapter" href="Ida_bbd.html">
<link title="Idas_bbd" rel="Chapter" href="Idas_bbd.html">
<link title="Nvector_openmp" rel="Chapter" href="Nvector_openmp.html">
<link title="Nvector_pthreads" rel="Chapter" href="Nvector_pthreads.html"><title>Sundials/ML 2.6.2p1 : Spils.PCG</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Spils.SPTFQMR.html" title="Spils.SPTFQMR">Previous</a>
&nbsp;<a class="up" href="Spils.html" title="Spils">Up</a>
&nbsp;</div>
<h1>Module <a href="type_Spils.PCG.html">Spils.PCG</a></h1>

<pre><span class="keyword">module</span> PCG: <code class="code"><span class="keyword">sig</span></code> <a href="Spils.PCG.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info module top">
The Preconditioned Conjugate-Gradient (PCG) method.<br>
</div>
<hr width="100%">

<pre><span id="TYPEt"><span class="keyword">type</span> <code class="type">('d, 'k)</code> t</span> </pre>
<div class="info ">
An instance of the PCG solver.<br>
<b>Since</b> 2.6.0<br>
<div class="sundials"><span class="seesundials">See sundials: </span>The PCG Module</div></div>


<pre><span id="VALmake"><span class="keyword">val</span> make</span> : <code class="type">int -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> ('d, 'k) <a href="Spils.PCG.html#TYPEt">t</a></code></pre><div class="info ">
<code class="code">make lmax temp</code> returns a solver session. <code class="code">lmax</code> is the maximum
        Krylov subspace dimension to use, and <code class="code">temp</code> sets the problem size.<br>
<div class="sundials"><span class="seesundials">See sundials: </span>PcgMalloc</div></div>

<pre><span id="VALsolve"><span class="keyword">val</span> solve</span> : <code class="type">('d, 'k) <a href="Spils.PCG.html#TYPEt">t</a> -><br>       x:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -><br>       b:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -><br>       delta:float -><br>       w:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -><br>       ?psolve:'d <a href="Spils.html#TYPEpsolve">Spils.psolve</a> -><br>       'd <a href="Spils.html#TYPEatimes">Spils.atimes</a> -> <a href="Spils.html#TYPEpreconditioning_type">Spils.preconditioning_type</a> -> bool * float * int * int</code></pre><div class="info ">
Solves the linear system <code class="code"><span class="constructor">Ax</span> = b</code> using the PCG iterative method.
        The <code class="code">atimes</code> function computes the matrix vector product <code class="code"><span class="constructor">Ax</span></code>, the
        other arguments are described below. The function returns a tuple
        <code class="code">(solved, res_norm, nli, nps)</code> where <code class="code">solved</code> indicates whether the
        system converged, <code class="code">res_norm</code> is the L2 norm of the scaled
        preconditioned residual
        $\lVert b - Ax \rVert_{L2}$ , and,
        <code class="code">nli</code> and <code class="code">nps</code> count, respectively, linear iterations performed and
        calls to <code class="code">psolve</code>. Repeated calls can be made to <code class="code">solve</code> with
        varying input arguments, but a new session must be created if either
        the problem size or the maximum Krylov dimension change.<br>
<div class="raisedexceptions"><span class="raises">Raises</span><ul><li><code>ConvFailure</code> Failed to converge</li>
<li><code>PSolveFailure</code> The <code class="code">psolve</code> function failed</li>
<li><code>ATimesFailure</code> The <code class="code">atimes</code> function failed</li>
<li><code>PSetFailure</code> pset failed</li>
</ul></div>
<div class="sundials arkode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/ark_guide/node9.html#ss:pcg">PcgSolve</a></div></div>
<div class="param_info"><code class="code">x</code> : initial guess on entry; result on return</div>
<div class="param_info"><code class="code">b</code> : right-hand side vector</div>
<div class="param_info"><code class="code">delta</code> : tolerance of the L2 norm: <code class="code">res_norm &lt;= delta</code></div>
<div class="param_info"><code class="code">w</code> : used in computing the residual norm for stopping solver</div>
<div class="param_info"><code class="code">psolve</code> : optionally solves the preconditioner system.</div>
</body></html>