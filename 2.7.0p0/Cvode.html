<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="docstyle.css" type="text/css">
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});
</script><script type="text/javascript"
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link rel="previous" href="Nvector_serial.html">
<link rel="next" href="Kinsol.html">
<link rel="Up" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Sundials" rel="Chapter" href="Sundials.html">
<link title="Nvector" rel="Chapter" href="Nvector.html">
<link title="Dls" rel="Chapter" href="Dls.html">
<link title="Sls" rel="Chapter" href="Sls.html">
<link title="Spils" rel="Chapter" href="Spils.html">
<link title="Nvector_custom" rel="Chapter" href="Nvector_custom.html">
<link title="Nvector_array" rel="Chapter" href="Nvector_array.html">
<link title="Nvector_serial" rel="Chapter" href="Nvector_serial.html">
<link title="Cvode" rel="Chapter" href="Cvode.html">
<link title="Kinsol" rel="Chapter" href="Kinsol.html">
<link title="Ida" rel="Chapter" href="Ida.html">
<link title="Arkode" rel="Chapter" href="Arkode.html">
<link title="Cvodes" rel="Chapter" href="Cvodes.html">
<link title="Idas" rel="Chapter" href="Idas.html">
<link title="Nvector_parallel" rel="Chapter" href="Nvector_parallel.html">
<link title="Kinsol_bbd" rel="Chapter" href="Kinsol_bbd.html">
<link title="Arkode_bbd" rel="Chapter" href="Arkode_bbd.html">
<link title="Cvode_bbd" rel="Chapter" href="Cvode_bbd.html">
<link title="Cvodes_bbd" rel="Chapter" href="Cvodes_bbd.html">
<link title="Ida_bbd" rel="Chapter" href="Ida_bbd.html">
<link title="Idas_bbd" rel="Chapter" href="Idas_bbd.html">
<link title="Nvector_openmp" rel="Chapter" href="Nvector_openmp.html">
<link title="Nvector_pthreads" rel="Chapter" href="Nvector_pthreads.html"><link title="Linear solvers" rel="Section" href="#linear">
<link title="Tolerances" rel="Section" href="#tols">
<link title="Solver initialization and use" rel="Section" href="#solver">
<link title="Modifying the solver (optional input functions)" rel="Section" href="#set">
<link title="Querying the solver (optional output functions)" rel="Section" href="#get">
<link title="Additional root-finding functions" rel="Section" href="#roots">
<link title="Exceptions" rel="Section" href="#exceptions">
<title>Sundials/ML 2.7.0p0 : Cvode</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Nvector_serial.html" title="Nvector_serial">Previous</a>
&nbsp;<a class="up" href="index.html" title="Index">Up</a>
&nbsp;<a class="post" href="Kinsol.html" title="Kinsol">Next</a>
</div>
<h1>Module <a href="type_Cvode.html">Cvode</a></h1>

<pre><span class="keyword">module</span> Cvode: <code class="code"><span class="keyword">sig</span></code> <a href="Cvode.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info module top">
Variable-step solution of ODE initial value problems with
    zero-crossing detection.
<p>

    This module solves numerically problems of the form
    $\dot{y} = f(t, y)$, $y(t_0) = y_0$.
<p>

    This documented interface is structured as follows.
    <OL>
<li><a href="#linear">Linear solvers</a></li>
<li><a href="#tols">Tolerances</a></li>
<li><a href="#solver">Solver initialization and use</a></li>
<li><a href="#set">Modifying the solver</a></li>
<li><a href="#get">Querying the solver</a></li>
<li><a href="#roots">Additional root finding functions</a></li>
<li><a href="#exceptions">Exceptions</a></li>
</OL>
<br>
<div class="authors"><b>Author(s):</b> Timothy Bourke (Inria/ENS), Jun Inoue (Inria/ENS), Marc Pouzet (UPMC/ENS/Inria)</div>
<b>Version:</b> 2.7.0<br>
</div>
<hr width="100%">

<pre><span id="TYPEsession"><span class="keyword">type</span> <code class="type">('d, 'k)</code> session</span> = <code class="type">('d, 'k) session</code> </pre>
<div class="info ">
A session with the CVODE solver.
<p>

    An example session with Cvode (<a href="cvode_skel.ml">cvode_skel.ml</a>): <pre class="codepre"><code class="code"><span class="comment">(*&nbsp;1.&nbsp;Define&nbsp;a&nbsp;right-hand-side&nbsp;function.&nbsp;*)</span>
<span class="keyword">let</span>&nbsp;f&nbsp;t&nbsp;y&nbsp;yd&nbsp;=&nbsp;yd.{0}&nbsp;&lt;-&nbsp;y.{1};&nbsp;yd.{1}&nbsp;&lt;-&nbsp;-9.81

<span class="comment">(*&nbsp;2.&nbsp;Optionally&nbsp;define&nbsp;a&nbsp;root&nbsp;function.&nbsp;*)</span>
<span class="keyword">let</span>&nbsp;g&nbsp;t&nbsp;y&nbsp;gout&nbsp;=&nbsp;gout.{0}&nbsp;&lt;-&nbsp;1.0&nbsp;-.&nbsp;y.{0}

<span class="comment">(*&nbsp;3.&nbsp;Set&nbsp;vector&nbsp;of&nbsp;initial&nbsp;values.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;length&nbsp;of&nbsp;this&nbsp;vector&nbsp;determines&nbsp;the&nbsp;problem&nbsp;size.&nbsp;*)</span>
<span class="keyword">let</span>&nbsp;yd&nbsp;=&nbsp;<span class="constructor">Sundials</span>.<span class="constructor">RealArray</span>.of_list&nbsp;[&nbsp;10.0;&nbsp;0.0&nbsp;]
<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Nvector_serial</span>.wrap&nbsp;yd

<span class="comment">(*&nbsp;4.&nbsp;Create&nbsp;and&nbsp;initialize&nbsp;a&nbsp;solver&nbsp;session.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;will&nbsp;initialize&nbsp;a&nbsp;specific&nbsp;linear&nbsp;solver&nbsp;and&nbsp;the&nbsp;root-finding
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mechanism,&nbsp;if&nbsp;necessary.&nbsp;*)</span>
<span class="keyword">let</span>&nbsp;s&nbsp;=&nbsp;<span class="constructor">Cvode</span>.(init&nbsp;<span class="constructor">Adams</span>&nbsp;<span class="constructor">Functional</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="constructor">SStolerances</span>&nbsp;(1e-4,&nbsp;1e-8))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;~roots:(1,&nbsp;g)&nbsp;0.0&nbsp;y);;

<span class="comment">(*&nbsp;5.&nbsp;Set&nbsp;optional&nbsp;inputs,&nbsp;e.g.,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;[set_*]&nbsp;functions&nbsp;to&nbsp;change&nbsp;solver&nbsp;parameters.&nbsp;*)</span>
<span class="constructor">Cvode</span>.set_stop_time&nbsp;s&nbsp;10.0;;
<span class="constructor">Cvode</span>.set_all_root_directions&nbsp;s&nbsp;<span class="constructor">Sundials</span>.<span class="constructor">RootDirs</span>.<span class="constructor">Increasing</span>;;

<span class="comment">(*&nbsp;6.&nbsp;Advance&nbsp;the&nbsp;solution&nbsp;in&nbsp;time,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by&nbsp;repeatedly&nbsp;calling&nbsp;[solve_normal]&nbsp;or&nbsp;[solve_one_step].&nbsp;*)</span>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;go&nbsp;(t,&nbsp;r)&nbsp;=
&nbsp;&nbsp;<span class="constructor">Printf</span>.printf&nbsp;<span class="string">"%&nbsp;.10e\t%&nbsp;.10e\t%&nbsp;.10e\n"</span>&nbsp;t&nbsp;yd.{0}&nbsp;yd.{1};
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;r&nbsp;<span class="keyword">with</span>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Cvode</span>.<span class="constructor">Success</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;go&nbsp;(<span class="constructor">Cvode</span>.solve_normal&nbsp;s&nbsp;(t&nbsp;+.&nbsp;0.5)&nbsp;y)
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Cvode</span>.<span class="constructor">RootsFound</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">begin</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yd.{1}&nbsp;&lt;-&nbsp;-0.8&nbsp;*.&nbsp;yd.{1};
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Cvode</span>.reinit&nbsp;s&nbsp;t&nbsp;y;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;go&nbsp;(t,&nbsp;<span class="constructor">Cvode</span>.<span class="constructor">Success</span>)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Cvode</span>.<span class="constructor">StopTimeReached</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;();;

<span class="constructor">Printf</span>.printf&nbsp;<span class="string">"time\ty\ty'\n"</span>;;
go&nbsp;(0.0,&nbsp;<span class="constructor">Cvode</span>.<span class="constructor">Success</span>);;

<span class="comment">(*&nbsp;7.&nbsp;Get&nbsp;optional&nbsp;outputs,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;the&nbsp;[get_*]&nbsp;functions&nbsp;to&nbsp;examine&nbsp;solver&nbsp;statistics.&nbsp;*)</span>
<span class="keyword">let</span>&nbsp;ns&nbsp;=&nbsp;<span class="constructor">Cvode</span>.get_num_steps&nbsp;s
&nbsp;&nbsp;&nbsp;&nbsp;</code></pre><br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#ss:skeleton_sim">Skeleton of main program</a></div></div>


<pre><span id="TYPEserial_session"><span class="keyword">type</span> <code class="type">[> <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ]</code> serial_session</span> = <code class="type">(<a href="Nvector_serial.html#TYPEdata">Nvector_serial.data</a>, [> <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ] as 'a) <a href="Cvode.html#TYPEsession">session</a></code> </pre>
<div class="info ">
Alias for sessions based on serial nvectors.<br>
</div>

<br>
<h2 id="linear">Linear solvers</h2><br>

<pre><span id="TYPElinear_solver"><span class="keyword">type</span> <code class="type">('data, 'kind)</code> linear_solver</span> = <code class="type">('data, 'kind) linear_solver</code> </pre>
<div class="info ">
Linear solvers used by Cvode.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:lin_solv_init">Linear Solver Specification Functions</a></div></div>


<pre><span id="TYPEserial_linear_solver"><span class="keyword">type</span> <code class="type">[> <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ]</code> serial_linear_solver</span> = <code class="type">(<a href="Nvector_serial.html#TYPEdata">Nvector_serial.data</a>, [> <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ] as 'a) <a href="Cvode.html#TYPElinear_solver">linear_solver</a></code> </pre>
<div class="info ">
Alias for linear solvers that are restricted to serial nvectors.<br>
</div>


<pre><span id="TYPEdouble"><span class="keyword">type</span> <code class="type">'d</code> double</span> = <code class="type">'d * 'd</code> </pre>
<div class="info ">
Workspaces with two temporary vectors.<br>
</div>


<pre><span id="TYPEtriple"><span class="keyword">type</span> <code class="type">'d</code> triple</span> = <code class="type">'d * 'd * 'd</code> </pre>
<div class="info ">
Workspaces with three temporary vectors.<br>
</div>


<pre><span id="TYPEjacobian_arg"><span class="keyword">type</span> <code class="type">('t, 'd)</code> jacobian_arg</span> = <code class="type">('t, 'd) jacobian_arg</code> = {</pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTjacobian_arg.jac_t">jac_t</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The independent variable.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTjacobian_arg.jac_y">jac_y</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The dependent variable vector.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTjacobian_arg.jac_fy">jac_fy</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The derivative vector
                            (i.e., $\frac{\mathrm{d}y}{\mathrm{d}t}$).<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTjacobian_arg.jac_tmp">jac_tmp</span>&nbsp;: <code class="type">'t</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Workspace data.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
}

<div class="info ">
Arguments common to Jacobian callback functions.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#ss:djacFn">CVDlsDenseJacFn</a></div><div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#ss:bjacFn">CVDlsBandJacFn</a></div><div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#ss:jtimesfn">CVSpilsJacTimesVecFn</a></div><div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#ss:psolveFn">CVSpilsPrecSolveFn</a></div><div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#ss:precondFn">CVSpilsPrecSetupFn</a></div></div>


<pre><span id="TYPEbandrange"><span class="keyword">type</span> <code class="type"></code>bandrange</span> = <code class="type">bandrange</code> = {</pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTbandrange.mupper">mupper</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The upper half-bandwidth.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTbandrange.mlower">mlower</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The lower half-bandwidth.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
}

<div class="info ">
The range of nonzero entries in a band matrix.<br>
</div>


<pre><span class="keyword">module</span> <a href="Cvode.Diag.html">Diag</a>: <code class="code"><span class="keyword">sig</span></code> <a href="Cvode.Diag.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
Diagonal approximation of Jacobians by difference quotients.
</div>

<pre><span class="keyword">module</span> <a href="Cvode.Dls.html">Dls</a>: <code class="code"><span class="keyword">sig</span></code> <a href="Cvode.Dls.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
Direct Linear Solvers operating on dense and banded matrices.
</div>

<pre><span class="keyword">module</span> <a href="Cvode.Sls.html">Sls</a>: <code class="code"><span class="keyword">sig</span></code> <a href="Cvode.Sls.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
Sparse Linear Solvers.
</div>

<pre><span class="keyword">module</span> <a href="Cvode.Spils.html">Spils</a>: <code class="code"><span class="keyword">sig</span></code> <a href="Cvode.Spils.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
Scaled Preconditioned Iterative Linear Solvers.
</div>

<pre><span class="keyword">module</span> <a href="Cvode.Alternate.html">Alternate</a>: <code class="code"><span class="keyword">sig</span></code> <a href="Cvode.Alternate.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
Alternate Linear Solvers.
</div>
<br>
<h2 id="tols">Tolerances</h2><br>

<pre><span id="TYPEerror_weight_fun"><span class="keyword">type</span> <code class="type">'data</code> error_weight_fun</span> = <code class="type">'data -> 'data -> unit</code> </pre>
<div class="info ">
Functions that set the multiplicative error weights for use in the weighted
    RMS norm. The call <code class="code">efun y ewt</code> takes the dependent variable vector <code class="code">y</code> and
    fills the error-weight vector <code class="code">ewt</code> with positive values or raises
    <a href="Sundials.html#EXCEPTIONNonPositiveEwt"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">NonPositiveEwt</span></code></a>. Other exceptions are eventually propagated, but
    should be avoided (<code class="code">efun</code> is not allowed to abort the solver).<br>
</div>


<pre><code><span id="TYPEtolerance"><span class="keyword">type</span> <code class="type">('data, 'kind)</code> tolerance</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtolerance.SStolerances"><span class="constructor">SStolerances</span></span> <span class="keyword">of</span> <code class="type">float * float</code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<code class="code">(rel, abs)</code> : scalar relative and absolute tolerances.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtolerance.SVtolerances"><span class="constructor">SVtolerances</span></span> <span class="keyword">of</span> <code class="type">float * ('data, 'kind) <a href="Nvector.html#TYPEt">Nvector.t</a></code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<code class="code">(rel, abs)</code> : scalar relative and vector absolute tolerances.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtolerance.WFtolerances"><span class="constructor">WFtolerances</span></span> <span class="keyword">of</span> <code class="type">'data <a href="Cvode.html#TYPEerror_weight_fun">error_weight_fun</a></code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Set the multiplicative error weights for the weighted RMS norm.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
Tolerance specifications.<br>
</div>


<pre><span id="VALdefault_tolerances"><span class="keyword">val</span> default_tolerances</span> : <code class="type">('data, 'kind) <a href="Cvode.html#TYPEtolerance">tolerance</a></code></pre><div class="info ">
A default relative tolerance of 1.0e-4 and absolute tolerance of 1.0e-8.<br>
</div>
<br>
<h2 id="solver">Solver initialization and use</h2><br>

<pre><code><span id="TYPEiter"><span class="keyword">type</span> <code class="type">('d, 'kind)</code> iter</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTiter.Newton"><span class="constructor">Newton</span></span> <span class="keyword">of</span> <code class="type">('d, 'kind) <a href="Cvode.html#TYPElinear_solver">linear_solver</a></code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Newton iteration with a given linear solver.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTiter.Functional"><span class="constructor">Functional</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Functional iteration (non-stiff systems only).<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
Choice of method for solving non-linear systems that arise in solver
    formulas.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node3.html#ss:ivp_sol">IVP Solution</a></div><div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvodemalloc">CVodeCreate</a></div></div>


<pre><code><span id="TYPElmm"><span class="keyword">type</span> <code class="type"></code>lmm</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlmm.Adams"><span class="constructor">Adams</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Adams-Moulton formulas (non-stiff systems).<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlmm.BDF"><span class="constructor">BDF</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Backward Differentiation Formulas (stiff systems).<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
Choice of linear multistep method.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node3.html#ss:ivp_sol">IVP Solution</a></div><div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvodemalloc">CVodeCreate</a></div></div>


<pre><span id="TYPErhsfn"><span class="keyword">type</span> <code class="type">'d</code> rhsfn</span> = <code class="type">float -> 'd -> 'd -> unit</code> </pre>
<div class="info ">
Right-hand side functions for calculating ODE derivatives. They are passed
    three arguments:<ul>
<li><code class="code">t</code>, the value of the independent variable, i.e., the simulation time,</li>
<li><code class="code">y</code>, the vector of dependent-variable values, i.e., $y(t)$, and,</li>
<li><code class="code">y'</code>, a vector for storing the value of $f(t, y)$.</li>
</ul>

    Within the function, raising a <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> exception
    indicates a recoverable error. Any other exception is treated as an
    unrecoverable error.
<p>

    <div class="warningbox"> <code class="code">y</code> and <code class="code">y'</code> should not be accessed after the function
             returns.</div><br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#ss:rhsFn">CVRhsFn</a></div></div>


<pre><span id="TYPErootsfn"><span class="keyword">type</span> <code class="type">'d</code> rootsfn</span> = <code class="type">float -> 'd -> <a href="Sundials.RealArray.html#TYPEt">Sundials.RealArray.t</a> -> unit</code> </pre>
<div class="info ">
Called by the solver to calculate the values of root functions. These
    ‘zero-crossings’ are used to detect significant events. The function is
    passed three arguments:<ul>
<li><code class="code">t</code>, the value of the independent variable, i.e., the simulation time,</li>
<li><code class="code">y</code>, the vector of dependent-variable values, i.e., $y(t)$, and,</li>
<li><code class="code">gout</code>, a vector for storing the value of $g(t, y)$.</li>
</ul>

    <div class="warningbox"> <code class="code">y</code> and <code class="code">gout</code> should not be accessed after the function has
             returned.</div><br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#ss:rootFn">cvRootFn</a></div></div>


<pre><span id="VALinit"><span class="keyword">val</span> init</span> : <code class="type"><a href="Cvode.html#TYPElmm">lmm</a> -><br>       ('data, 'kind) <a href="Cvode.html#TYPEiter">iter</a> -><br>       ('data, 'kind) <a href="Cvode.html#TYPEtolerance">tolerance</a> -><br>       'data <a href="Cvode.html#TYPErhsfn">rhsfn</a> -><br>       ?roots:int * 'data <a href="Cvode.html#TYPErootsfn">rootsfn</a> -><br>       float -> ('data, 'kind) <a href="Nvector.html#TYPEt">Nvector.t</a> -> ('data, 'kind) <a href="Cvode.html#TYPEsession">session</a></code></pre><div class="info ">
Creates and initializes a session with the solver. The call
    <pre class="codepre"><code class="code">init&nbsp;lmm&nbsp;iter&nbsp;tol&nbsp;f&nbsp;~roots:(nroots,&nbsp;g)&nbsp;t0&nbsp;y0</code></pre> has
    as arguments:<ul>
<li><code class="code">lmm</code>,    the linear multistep method (see <a href="Cvode.html#TYPElmm"><code class="code"><span class="constructor">Cvode</span>.lmm</code></a>),</li>
<li><code class="code">iter</code>,   either functional or Newton iteration (see <a href="Cvode.html#TYPEiter"><code class="code"><span class="constructor">Cvode</span>.iter</code></a>),</li>
<li><code class="code">tol</code>,    the integration tolerances,</li>
<li><code class="code">f</code>,      the ODE right-hand side function,</li>
<li><code class="code">nroots</code>, the number of root functions,</li>
<li><code class="code">g</code>,      the root function (<code class="code">(nroots, g)</code> defaults to <a href="Cvode.html#VALno_roots"><code class="code"><span class="constructor">Cvode</span>.no_roots</code></a>),</li>
<li><code class="code">t0</code>,     the initial value of the independent variable, and,</li>
<li><code class="code">y0</code>,     a vector of initial values that also determines the number
                of equations.</li>
</ul>

    This function does everything necessary to initialize a session, i.e.,
    it makes the calls referenced below. The <a href="Cvode.html#VALsolve_normal"><code class="code"><span class="constructor">Cvode</span>.solve_normal</code></a> and
    <a href="Cvode.html#VALsolve_one_step"><code class="code"><span class="constructor">Cvode</span>.solve_one_step</code></a> functions may be called directly.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvodemalloc">  CVodeCreate/CVodeInit</a></div><div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#ss:cvrootinit">    CVodeRootInit</a></div><div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:lin_solv_init">Linear solvers</a></div><div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvtolerances"> CVodeSStolerances</a></div><div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvtolerances"> CVodeSVtolerances</a></div><div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvtolerances"> CVodeWFtolerances</a></div><div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#ss:ewtsetFn">      CVEwtFn</a></div></div>

<pre><span id="VALno_roots"><span class="keyword">val</span> no_roots</span> : <code class="type">int * 'd <a href="Cvode.html#TYPErootsfn">rootsfn</a></code></pre><div class="info ">
A convenience value for signalling that there are no roots to monitor.<br>
</div>

<pre><code><span id="TYPEsolver_result"><span class="keyword">type</span> <code class="type"></code>solver_result</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsolver_result.Success"><span class="constructor">Success</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The solution was advanced. <span class="cconst">(CV_SUCCESS)</span><br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsolver_result.RootsFound"><span class="constructor">RootsFound</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
A root was found. See <a href="Cvode.html#VALget_root_info"><code class="code"><span class="constructor">Cvode</span>.get_root_info</code></a>.
                            <span class="cconst">(CV_ROOT_RETURN)</span><br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsolver_result.StopTimeReached"><span class="constructor">StopTimeReached</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The stop time was reached. See <a href="Cvode.html#VALset_stop_time"><code class="code"><span class="constructor">Cvode</span>.set_stop_time</code></a>.
                            <span class="cconst">(CV_TSTOP_RETURN)</span><br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
Values returned by the step functions. Failures are indicated by
    exceptions.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvode">CVode</a></div></div>


<pre><span id="VALsolve_normal"><span class="keyword">val</span> solve_normal</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -><br>       float -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> float * <a href="Cvode.html#TYPEsolver_result">solver_result</a></code></pre><div class="info ">
Integrates an ODE system over an interval. The call
    <code class="code">tret, r = solve_normal s tout yout</code> has as arguments<ul>
<li><code class="code">s</code>, a solver session,</li>
<li><code class="code">tout</code>, the next time at which a solution is desired, and,</li>
<li><code class="code">yout</code>, a vector to store the computed solution.</li>
</ul>

    It returns <code class="code">tret</code>, the time reached by the solver, which will be equal to
    <code class="code">tout</code> if no errors occur, and, <code class="code">r</code>, a <a href="Cvode.html#TYPEsolver_result"><code class="code"><span class="constructor">Cvode</span>.solver_result</code></a>.<br>
<div class="raisedexceptions"><span class="raises">Raises</span><ul><li><code>IllInput</code> Missing or illegal solver inputs.</li>
<li><code>TooClose</code> The initial and final times are too close to each other and not initial step size was specified.</li>
<li><code>TooMuchWork</code> The requested time could not be reached in <code class="code">mxstep</code> internal steps.</li>
<li><code>TooMuchAccuracy</code> The requested accuracy could not be satisfied.</li>
<li><code>ErrFailure</code> Too many error test failures within a step or at the minimum step size.</li>
<li><code>ConvergenceFailure</code> Too many convergence test failures within a step or at the minimum step size.</li>
<li><code>LinearInitFailure</code> Linear solver initialization failed.</li>
<li><code>LinearSetupFailure</code> Linear solver setup failed unrecoverably.</li>
<li><code>LinearSolveFailure</code> Linear solver solution failed unrecoverably.</li>
<li><code>RhsFuncFailure</code> Unrecoverable failure in the RHS function <code class="code">f</code>.</li>
<li><code>FirstRhsFuncFailure</code> Initial unrecoverable failure in the RHS function <code class="code">f</code>.</li>
<li><code>RepeatedRhsFuncFailure</code> Too many convergence test failures, or unable to estimate the initial step size, due to repeated recoverable errors in the right-hand side function.</li>
<li><code>UnrecoverableRhsFuncFailure</code> The right-hand side function had a recoverable error, but no recovery was possible. This error can only occur after an error test failure at order one.</li>
<li><code>RootFuncFailure</code> Failure in the rootfinding function <code class="code">g</code>.</li>
</ul></div>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvode">CVode (CV_NORMAL)</a></div></div>

<pre><span id="VALsolve_one_step"><span class="keyword">val</span> solve_one_step</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -><br>       float -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> float * <a href="Cvode.html#TYPEsolver_result">solver_result</a></code></pre><div class="info ">
Like <a href="Cvode.html#VALsolve_normal"><code class="code"><span class="constructor">Cvode</span>.solve_normal</code></a> but returns after one internal solver step.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvode">CVode (CV_ONE_STEP)</a></div></div>

<pre><span id="VALget_dky"><span class="keyword">val</span> get_dky</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> float -> int -> unit</code></pre><div class="info ">
Returns the interpolated solution or derivatives.
    <code class="code">get_dky s dky t k</code> computes the <code class="code">k</code>th derivative of the function at time
    <code class="code">t</code>, i.e., $\frac{d^\mathtt{k}y(\mathtt{t})}{\mathit{dt}^\mathtt{k}}$,
    and stores it in <code class="code">dky</code>. The arguments must satisfy
    $t_n - h_u \leq \mathtt{t} \leq t_n$—where $t_n$
    denotes <a href="Cvode.html#VALget_current_time"><code class="code"><span class="constructor">Cvode</span>.get_current_time</code></a> and $h_u$ denotes <a href="Cvode.html#VALget_last_step"><code class="code"><span class="constructor">Cvode</span>.get_last_step</code></a>,—
    and $0 \leq \mathtt{k} \leq q_u$—where $q_u$ denotes
    <a href="Cvode.html#VALget_last_order"><code class="code"><span class="constructor">Cvode</span>.get_last_order</code></a>.
<p>

    This function may only be called after a successful return from either
    <a href="Cvode.html#VALsolve_normal"><code class="code"><span class="constructor">Cvode</span>.solve_normal</code></a> or <a href="Cvode.html#VALsolve_one_step"><code class="code"><span class="constructor">Cvode</span>.solve_one_step</code></a>.<br>
<div class="raisedexceptions"><span class="raises">Raises</span><ul><li><code>BadT</code> <code class="code">t</code> is not in the interval $[t_n - h_u, t_n]$.</li>
<li><code>BadK</code> <code class="code">k</code> is not in the range 0, 1, ..., $q_u$.</li>
</ul></div>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_root">CVodeGetDky</a></div></div>

<pre><span id="VALreinit"><span class="keyword">val</span> reinit</span> : <code class="type">('d, 'kind) <a href="Cvode.html#TYPEsession">session</a> -><br>       ?iter_type:('d, 'kind) <a href="Cvode.html#TYPEiter">iter</a> -><br>       ?roots:int * 'd <a href="Cvode.html#TYPErootsfn">rootsfn</a> -> float -> ('d, 'kind) <a href="Nvector.html#TYPEt">Nvector.t</a> -> unit</code></pre><div class="info ">
Reinitializes the solver with new parameters and state values. The
    values of the independent variable, i.e., the simulation time, and the
    state variables must be given. If given, <code class="code">iter_type</code> specifies a new
    iteration method, and <code class="code">roots</code> specifies a new root finding function;
    both default to unchanged.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvreinit">CVodeReInit</a></div></div>
<br>
<h2 id="set">Modifying the solver (optional input functions)</h2><br>

<pre><span id="VALset_tolerances"><span class="keyword">val</span> set_tolerances</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> ('d, 'k) <a href="Cvode.html#TYPEtolerance">tolerance</a> -> unit</code></pre><div class="info ">
Sets the integration tolerances.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvtolerances">CVodeSStolerances</a></div><div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvtolerances">CVodeSVtolerances</a></div><div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvtolerances">CVodeWFtolerances</a></div><div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#ss:ewtsetFn">      CVEwtFn</a></div></div>

<pre><span id="VALset_error_file"><span class="keyword">val</span> set_error_file</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> <a href="Sundials.Logfile.html#TYPEt">Sundials.Logfile.t</a> -> unit</code></pre><div class="info ">
Configure the default error handler to write messages to a file.
    By default it writes to Sundials.Logfile.stderr.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_main">CVodeSetErrFile</a></div></div>

<pre><span id="VALset_err_handler_fn"><span class="keyword">val</span> set_err_handler_fn</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> (<a href="Sundials.html#TYPEerror_details">Sundials.error_details</a> -> unit) -> unit</code></pre><div class="info ">
Specifies a custom function for handling error messages.
    The handler must not fail: any exceptions are trapped and discarded.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_main">CVodeSetErrHandlerFn</a></div><div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#ss:ehFn">CVErrHandlerFn</a></div></div>

<pre><span id="VALclear_err_handler_fn"><span class="keyword">val</span> clear_err_handler_fn</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
Restores the default error handling function.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_main">CVodeSetErrHandlerFn</a></div></div>

<pre><span id="VALset_max_ord"><span class="keyword">val</span> set_max_ord</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
Specifies the maximum order of the linear multistep method.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_main">CVodeSetMaxOrd</a></div></div>

<pre><span id="VALset_max_num_steps"><span class="keyword">val</span> set_max_num_steps</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
Specifies the maximum number of steps taken in attempting to reach
    a given output time.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_main">CVodeSetMaxNumSteps</a></div></div>

<pre><span id="VALset_max_hnil_warns"><span class="keyword">val</span> set_max_hnil_warns</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
Specifies the maximum number of messages warning that <code class="code">t + h = t</code> on
    the next internal step.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_main">CVodeSetMaxHnilWarns</a></div></div>

<pre><span id="VALset_stab_lim_det"><span class="keyword">val</span> set_stab_lim_det</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> bool -> unit</code></pre><div class="info ">
Indicates whether the BDF stability limit detection algorithm should be
    used.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_main">CVodeSetStabLimDet</a></div><div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node3.html#s:bdf_stab">BDF Stability Limit Detection</a></div></div>

<pre><span id="VALset_init_step"><span class="keyword">val</span> set_init_step</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
Specifies the initial step size.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_main">CVodeSetInitStep</a></div></div>

<pre><span id="VALset_min_step"><span class="keyword">val</span> set_min_step</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
Specifies a lower bound on the magnitude of the step size.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_main">CVodeSetMinStep</a></div></div>

<pre><span id="VALset_max_step"><span class="keyword">val</span> set_max_step</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
Specifies an upper bound on the magnitude of the step size.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_main">CVodeSetMaxStep</a></div></div>

<pre><span id="VALset_stop_time"><span class="keyword">val</span> set_stop_time</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
Limits the value of the independent variable <code class="code">t</code> when solving.
    By default no stop time is imposed.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_main">CVodeSetStopTime</a></div></div>

<pre><span id="VALset_max_err_test_fails"><span class="keyword">val</span> set_max_err_test_fails</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
Specifies the maximum number of error test failures permitted in attempting
    one step.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_main">CVodeSetMaxErrTestFails</a></div></div>

<pre><span id="VALset_max_nonlin_iters"><span class="keyword">val</span> set_max_nonlin_iters</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
Specifies the maximum number of nonlinear solver iterations permitted per
    step.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_main">CVodeSetMaxNonlinIters</a></div></div>

<pre><span id="VALset_max_conv_fails"><span class="keyword">val</span> set_max_conv_fails</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
Specifies the maximum number of nonlinear solver convergence failures
    permitted during one step.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_main">CVodeSetMaxConvFails</a></div></div>

<pre><span id="VALset_nonlin_conv_coef"><span class="keyword">val</span> set_nonlin_conv_coef</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
Specifies the safety factor used in the nonlinear convergence test.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_main">CVodeSetNonlinConvCoef</a></div><div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node3.html#ss:ivp_sol">IVP Solution</a></div></div>
<br>
<h2 id="get">Querying the solver (optional output functions)</h2><br>

<pre><span id="VALget_work_space"><span class="keyword">val</span> get_work_space</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int * int</code></pre><div class="info ">
Returns the real and integer workspace sizes.<br>
<b>Returns</b> (<code class="code">real_size</code>, <code class="code">integer_size</code>)<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_main">CVodeGetWorkSpace</a></div></div>

<pre><span id="VALget_num_steps"><span class="keyword">val</span> get_num_steps</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
Returns the cumulative number of internal steps taken by the solver.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_main">CVodeGetNumSteps</a></div></div>

<pre><span id="VALget_num_rhs_evals"><span class="keyword">val</span> get_num_rhs_evals</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
Returns the number of calls to the right-hand side function.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_main">CVodeGetNumRhsEvals</a></div></div>

<pre><span id="VALget_num_lin_solv_setups"><span class="keyword">val</span> get_num_lin_solv_setups</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
Returns the number of calls made to the linear solver's setup function.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_main">CVodeGetNumLinSolvSetups</a></div></div>

<pre><span id="VALget_num_err_test_fails"><span class="keyword">val</span> get_num_err_test_fails</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
Returns the number of local error test failures that have occurred.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_main">CVodeGetNumErrTestFails</a></div></div>

<pre><span id="VALget_last_order"><span class="keyword">val</span> get_last_order</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
Returns the integration method order used during the last internal step.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_main">CVodeGetLastOrder</a></div></div>

<pre><span id="VALget_current_order"><span class="keyword">val</span> get_current_order</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
Returns the integration method order to be used on the next internal step.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_main">CVodeGetCurrentOrder</a></div></div>

<pre><span id="VALget_last_step"><span class="keyword">val</span> get_last_step</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
Returns the integration step size taken on the last internal step.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_main">CVodeGetLastStep</a></div></div>

<pre><span id="VALget_current_step"><span class="keyword">val</span> get_current_step</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
Returns the integration step size to be attempted on the next internal step.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_main">CVodeGetCurrentStep</a></div></div>

<pre><span id="VALget_actual_init_step"><span class="keyword">val</span> get_actual_init_step</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
Returns the the value of the integration step size used on the first step.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_main">CVodeGetActualInitStep</a></div></div>

<pre><span id="VALget_current_time"><span class="keyword">val</span> get_current_time</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
Returns the the current internal time reached by the solver.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_main">CVodeGetCurrentTime</a></div></div>

<pre><span id="VALget_num_stab_lim_order_reds"><span class="keyword">val</span> get_num_stab_lim_order_reds</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
Returns the number of order reductions dictated by the BDF stability limit
    detection algorithm.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_main">CVodeGetNumStabLimOrderReds</a></div><div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node3.html#s:bdf_stab">BDF stability limit detection</a></div></div>

<pre><span id="VALget_tol_scale_factor"><span class="keyword">val</span> get_tol_scale_factor</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
Returns a suggested factor by which the user's tolerances should be scaled
    when too much accuracy has been requested for some internal step.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_main">CVodeGetTolScaleFactor</a></div></div>

<pre><span id="VALget_err_weights"><span class="keyword">val</span> get_err_weights</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> unit</code></pre><div class="info ">
Returns the solution error weights at the current time.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_main">CVodeGetErrWeights</a></div><div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node3.html#ss:ivp_sol">IVP solution (W_i)</a></div></div>

<pre><span id="VALget_est_local_errors"><span class="keyword">val</span> get_est_local_errors</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> unit</code></pre><div class="info ">
Returns the vector of estimated local errors.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_main">CVodeGetEstLocalErrors</a></div></div>

<pre><code><span id="TYPEintegrator_stats"><span class="keyword">type</span> <code class="type"></code>integrator_stats</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.num_steps">num_steps</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Cumulative number of internal solver steps.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.num_rhs_evals">num_rhs_evals</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Number of calls to the right-hand side function.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.num_lin_solv_setups">num_lin_solv_setups</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Number of setups calls to the linear solver.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.num_err_test_fails">num_err_test_fails</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Number of local error test failures.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.last_order">last_order</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Integration method order used in the last internal step.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.current_order">current_order</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Integration method order to be used in the next internal step.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.actual_init_step">actual_init_step</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Integration step sized used on the first step.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.last_step">last_step</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Integration step size of the last internal step.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.current_step">current_step</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Integration step size to attempt on the next internal step.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.current_time">current_time</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Current internal time reached by the solver.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
}

<div class="info ">
Summaries of integrator statistics.<br>
</div>


<pre><span id="VALget_integrator_stats"><span class="keyword">val</span> get_integrator_stats</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> <a href="Cvode.html#TYPEintegrator_stats">integrator_stats</a></code></pre><div class="info ">
Returns the integrator statistics as a group.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_main">CVodeGetIntegratorStats</a></div></div>

<pre><span id="VALprint_integrator_stats"><span class="keyword">val</span> print_integrator_stats</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> Pervasives.out_channel -> unit</code></pre><div class="info ">
Prints the integrator statistics on the given channel.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_main">CVodeGetIntegratorStats</a></div></div>

<pre><span id="VALget_num_nonlin_solv_iters"><span class="keyword">val</span> get_num_nonlin_solv_iters</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
Returns the number of nonlinear (functional or Newton) iterations performed.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_main">CVodeGetNumNonlinSolvIters</a></div></div>

<pre><span id="VALget_num_nonlin_solv_conv_fails"><span class="keyword">val</span> get_num_nonlin_solv_conv_fails</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
Returns the number of nonlinear convergence failures that have occurred.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_main">CVodeGetNumNonlinSolvConvFails</a></div></div>

<pre><span id="VALget_nonlin_solv_stats"><span class="keyword">val</span> get_nonlin_solv_stats</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int * int</code></pre><div class="info ">
Returns both the numbers of nonlinear iterations performed <code class="code">nniters</code> and
    nonlinear convergence failures <code class="code">nncfails</code>.<br>
<b>Returns</b> (<code class="code">nniters</code>, <code class="code">nncfails</code>)<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_main">CVodeGetNonlinSolvStats</a></div></div>
<br>
<h2 id="roots">Additional root-finding functions</h2><br>

<pre><span id="VALset_root_direction"><span class="keyword">val</span> set_root_direction</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> <a href="Sundials.RootDirs.html#TYPEd">Sundials.RootDirs.d</a> array -> unit</code></pre><div class="info ">
<code class="code">set_root_direction s dir</code> specifies the direction of zero-crossings to be
    located and returned. <code class="code">dir</code> may contain one entry for each root function.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_root">CVodeSetRootDirection</a></div></div>

<pre><span id="VALset_all_root_directions"><span class="keyword">val</span> set_all_root_directions</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> <a href="Sundials.RootDirs.html#TYPEd">Sundials.RootDirs.d</a> -> unit</code></pre><div class="info ">
Like <a href="Cvode.html#VALset_root_direction"><code class="code"><span class="constructor">Cvode</span>.set_root_direction</code></a> but specifies a single direction for all root
    functions.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_root">CVodeSetRootDirection</a></div></div>

<pre><span id="VALset_no_inactive_root_warn"><span class="keyword">val</span> set_no_inactive_root_warn</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
Disables issuing a warning if some root function appears to be identically
    zero at the beginning of the integration.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_root">CVodeSetNoInactiveRootWarn</a></div></div>

<pre><span id="VALget_num_roots"><span class="keyword">val</span> get_num_roots</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
Returns the number of root functions.<br>
</div>

<pre><span id="VALget_root_info"><span class="keyword">val</span> get_root_info</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> <a href="Sundials.Roots.html#TYPEt">Sundials.Roots.t</a> -> unit</code></pre><div class="info ">
Fills an array showing which functions were found to have a root.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_root">CVodeGetRootInfo</a></div></div>

<pre><span id="VALget_num_g_evals"><span class="keyword">val</span> get_num_g_evals</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
Returns the cumulative number of calls made to the user-supplied root
    function g.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_root">CVodeGetNumGEvals</a></div></div>
<br>
<h2 id="exceptions">Exceptions</h2><br>

<pre><span id="EXCEPTIONIllInput"><span class="keyword">exception</span> IllInput</span></pre>
<div class="info ">
Raised on missing or illegal solver inputs. Also raised if an element
    of the error weight vector becomes zero during time stepping, or the
    linear solver initialization function failed, or a root was found both at
    <code class="code">t</code> and very near <code class="code">t</code>.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvode">CV_ILL_INPUT</a></div></div>

<pre><span id="EXCEPTIONTooClose"><span class="keyword">exception</span> TooClose</span></pre>
<div class="info ">
The initial and final times are too close to each other and an initial step
    size was not specified.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvode">CV_TOO_CLOSE</a></div></div>

<pre><span id="EXCEPTIONTooMuchWork"><span class="keyword">exception</span> TooMuchWork</span></pre>
<div class="info ">
The requested time could not be reached in <code class="code">mxstep</code> internal steps.
    See <a href="Cvode.html#VALset_max_num_steps"><code class="code"><span class="constructor">Cvode</span>.set_max_num_steps</code></a><br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvode">CV_TOO_MUCH_WORK</a></div></div>

<pre><span id="EXCEPTIONTooMuchAccuracy"><span class="keyword">exception</span> TooMuchAccuracy</span></pre>
<div class="info ">
The requested accuracy could not be satisfied.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvode">CV_TOO_MUCH_ACC</a></div></div>

<pre><span id="EXCEPTIONErrFailure"><span class="keyword">exception</span> ErrFailure</span></pre>
<div class="info ">
Too many error test failures within a step or at the minimum step size.
    See <a href="Cvode.html#VALset_max_err_test_fails"><code class="code"><span class="constructor">Cvode</span>.set_max_err_test_fails</code></a> and <a href="Cvode.html#VALset_min_step"><code class="code"><span class="constructor">Cvode</span>.set_min_step</code></a>.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvode">CV_ERR_FAILURE</a></div></div>

<pre><span id="EXCEPTIONConvergenceFailure"><span class="keyword">exception</span> ConvergenceFailure</span></pre>
<div class="info ">
Too many convergence test failures within a step or at the minimum step
    size. See <a href="Cvode.html#VALset_max_conv_fails"><code class="code"><span class="constructor">Cvode</span>.set_max_conv_fails</code></a> and <a href="Cvode.html#VALset_min_step"><code class="code"><span class="constructor">Cvode</span>.set_min_step</code></a>.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvode">CV_CONV_FAILURE</a></div></div>

<pre><span id="EXCEPTIONLinearInitFailure"><span class="keyword">exception</span> LinearInitFailure</span></pre>
<div class="info ">
Linear solver initialization failed.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvode">CV_LINIT_FAIL</a></div></div>

<pre><span id="EXCEPTIONLinearSetupFailure"><span class="keyword">exception</span> LinearSetupFailure</span></pre>
<div class="info ">
Linear solver setup failed in an unrecoverable manner.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvode">CV_LSETUP_FAIL</a></div></div>

<pre><span id="EXCEPTIONLinearSolveFailure"><span class="keyword">exception</span> LinearSolveFailure</span></pre>
<div class="info ">
Linear solver solution failed in an unrecoverable manner.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvode">CV_LSOLVE_FAIL</a></div></div>

<pre><span id="EXCEPTIONRhsFuncFailure"><span class="keyword">exception</span> RhsFuncFailure</span></pre>
<div class="info ">
The right-hand side function failed in an unrecoverable manner.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvode">CV_RHSFUNC_FAIL</a></div></div>

<pre><span id="EXCEPTIONFirstRhsFuncFailure"><span class="keyword">exception</span> FirstRhsFuncFailure</span></pre>
<div class="info ">
The right-hand side function had a recoverable error when first called.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvode">CV_FIRST_RHSFUNC_ERR</a></div></div>

<pre><span id="EXCEPTIONRepeatedRhsFuncFailure"><span class="keyword">exception</span> RepeatedRhsFuncFailure</span></pre>
<div class="info ">
Too many convergence test failures, or unable to estimate the initial step
    size, due to repeated recoverable errors in the right-hand side function.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvode">CV_REPTD_RHSFUNC_ERR</a></div></div>

<pre><span id="EXCEPTIONUnrecoverableRhsFuncFailure"><span class="keyword">exception</span> UnrecoverableRhsFuncFailure</span></pre>
<div class="info ">
The right-hand side function had a recoverable error, but no recovery was
    possible. This error can only occur after an error test failure at order
    one.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvode">CV_UNREC_RHSFUNC_ERR</a></div></div>

<pre><span id="EXCEPTIONRootFuncFailure"><span class="keyword">exception</span> RootFuncFailure</span></pre>
<div class="info ">
The rootfinding function failed.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:cvode">CV_RTFUNC_FAIL</a></div></div>

<pre><span id="EXCEPTIONBadK"><span class="keyword">exception</span> BadK</span></pre>
<div class="info ">
Raised by <a href="Cvode.html#VALget_dky"><code class="code"><span class="constructor">Cvode</span>.get_dky</code></a> for invalid order values.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#ss:optional_dky">CVodeGetDky (CV_BAD_K)</a></div></div>

<pre><span id="EXCEPTIONBadT"><span class="keyword">exception</span> BadT</span></pre>
<div class="info ">
Raised by <a href="Cvode.html#VALget_dky"><code class="code"><span class="constructor">Cvode</span>.get_dky</code></a> for invalid time values.<br>
<div class="sundials cvode"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#ss:optional_dky">CVodeGetDky (CV_BAD_T)</a></div></div>
</body></html>